<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.17"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: gr::KerrSchildCoords Class Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="popper.min.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="index.html">
      SpECTRE &#160;
        <span id="projectnumber">v2020.12.07</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Introduction</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="versioning_and_releases.html">
              <i class="octicon octicon-versions"></i><span>Releases</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="installation.html">
              <i class="octicon octicon-desktop-download"></i><span>Installation</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>User Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="code_of_conduct.html">
              <i class="octicon octicon-comment-discussion"></i><span>Code of Conduct</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="contributing_to_spectre.html">
              <i class="octicon octicon-git-pull-request"></i><span>Contributing Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Code Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Topics</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <li>
        <a href="citelist.html">
          <i class="octicon octicon-file-text"></i><span>Bibliography</span>
        </a>
      </li>
      <li>
        <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
          <i class="octicon octicon-mark-github"></i><span>View on GitHub</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegr.html">gr</a></li><li class="navelem"><a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classgr_1_1KerrSchildCoords-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">gr::KerrSchildCoords Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains helper functions for transforming tensors in Kerr spacetime to Kerr-Schild coordinates.  
 <a href="classgr_1_1KerrSchildCoords.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="KerrSchildCoords_8hpp_source.html">KerrSchildCoords.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae6b984dcde28604a6745eec75325ceb9"><td class="memItemLeft" align="right" valign="top"><a id="ae6b984dcde28604a6745eec75325ceb9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>KerrSchildCoords</b> (const <a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;)=delete</td></tr>
<tr class="separator:ae6b984dcde28604a6745eec75325ceb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e38f2e6eb7fe1fb53aa5a47e678f0d1"><td class="memItemLeft" align="right" valign="top"><a id="a4e38f2e6eb7fe1fb53aa5a47e678f0d1"></a>
<a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;)=delete</td></tr>
<tr class="separator:a4e38f2e6eb7fe1fb53aa5a47e678f0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a749e7341afbdfaaf9290661bf7d252"><td class="memItemLeft" align="right" valign="top"><a id="a6a749e7341afbdfaaf9290661bf7d252"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>KerrSchildCoords</b> (<a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:a6a749e7341afbdfaaf9290661bf7d252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e7d6e8522a32d3ff809865d5d1b6c43"><td class="memItemLeft" align="right" valign="top"><a id="a5e7d6e8522a32d3ff809865d5d1b6c43"></a>
<a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:a5e7d6e8522a32d3ff809865d5d1b6c43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a622ec562569164bb6a311638ebcea4c9"><td class="memItemLeft" align="right" valign="top"><a id="a622ec562569164bb6a311638ebcea4c9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>KerrSchildCoords</b> (double bh_mass, double bh_dimless_spin) noexcept</td></tr>
<tr class="separator:a622ec562569164bb6a311638ebcea4c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147333cd57555ea3bcc8aaf9b93a4427"><td class="memTemplParams" colspan="2"><a id="a147333cd57555ea3bcc8aaf9b93a4427"></a>
template&lt;typename DataType &gt; </td></tr>
<tr class="memitem:a147333cd57555ea3bcc8aaf9b93a4427"><td class="memTemplItemLeft" align="right" valign="top">tnsr::I&lt; DataType, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classgr_1_1KerrSchildCoords.html#a147333cd57555ea3bcc8aaf9b93a4427">cartesian_from_spherical_ks</a> (const tnsr::I&lt; DataType, 3, <a class="el" href="structFrame_1_1NoFrame.html">Frame::NoFrame</a> &gt; &amp;spatial_vector, const tnsr::I&lt; DataType, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;cartesian_coords) const noexcept</td></tr>
<tr class="memdesc:a147333cd57555ea3bcc8aaf9b93a4427"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a spatial vector from Kerr (or "spherical Kerr-Schild") coordinates to Cartesian Kerr-Schild coordinates. If applied on points on the z-axis, the vector to transform must have a vanishing \(v^\vartheta\) in order for the transformation to be single-valued. <br /></td></tr>
<tr class="separator:a147333cd57555ea3bcc8aaf9b93a4427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c323d5a5a319fc416b79aadf8b1166"><td class="memTemplParams" colspan="2"><a id="a24c323d5a5a319fc416b79aadf8b1166"></a>
template&lt;typename DataType &gt; </td></tr>
<tr class="memitem:a24c323d5a5a319fc416b79aadf8b1166"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="group__TensorGroup.html#ga06ebcb38a1f13c246e53378b9e8959ce">Scalar</a>&lt; DataType &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classgr_1_1KerrSchildCoords.html#a24c323d5a5a319fc416b79aadf8b1166">r_coord_squared</a> (const tnsr::I&lt; DataType, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;cartesian_coords) const noexcept</td></tr>
<tr class="memdesc:a24c323d5a5a319fc416b79aadf8b1166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kerr-Schild \(r^2\) in terms of the Cartesian coordinates. <br /></td></tr>
<tr class="separator:a24c323d5a5a319fc416b79aadf8b1166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5145f1d072da6e50397a59550067fc40"><td class="memItemLeft" align="right" valign="top"><a id="a5145f1d072da6e50397a59550067fc40"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pup</b> (PUP::er &amp;) noexcept</td></tr>
<tr class="separator:a5145f1d072da6e50397a59550067fc40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a400eb1da588b7de7d5dd32aabfa2d251"><td class="memItemLeft" align="right" valign="top"><a id="a400eb1da588b7de7d5dd32aabfa2d251"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (const <a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;lhs, const <a class="el" href="classgr_1_1KerrSchildCoords.html">KerrSchildCoords</a> &amp;rhs) noexcept</td></tr>
<tr class="separator:a400eb1da588b7de7d5dd32aabfa2d251"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains helper functions for transforming tensors in Kerr spacetime to Kerr-Schild coordinates. </p>
<p>Consider the Kerr-Schild form of the Kerr metric in Cartesian coordinates \( (t, x, y, z)\),</p>
<p class="formulaDsp">
\begin{align*} ds^2 = -dt^2 + dx^2 + dy^2 + dz^2 + \dfrac{2Mr^3}{r^4 + a^2 z^2} \left[dt + \dfrac{r(x\,dx + y\,dy)}{r^2 + a^2} + \dfrac{a(y\,dx - x\,dy)}{r^2 + a^2} + \dfrac{z}{r}dz\right]^2, \end{align*}
</p>
<p>where \(r\) is the function defined through</p>
<p class="formulaDsp">
\begin{align*} r^2(x, y, z) = \frac{x^2 + y^2 + z^2 - a^2}{2} + \sqrt{\left(\frac{x^2 + y^2 + z^2 - a^2}{2}\right)^2 + a^2 z^2}. \end{align*}
</p>
<p>Depending on the physical context, the following coordinate transformations are usually adopted:</p>
<ul>
<li><p class="startli"><em>Spherical</em> <em>coordinates</em>, defined by the usual transformation</p>
<p class="formulaDsp">
\begin{align*} x &amp;= r_\text{sph}\sin\theta\cos\phi,\\ y &amp;= r_\text{sph}\sin\theta\sin\phi,\\ z &amp;= r_\text{sph}\cos\theta. \end{align*}
</p>
<p class="startli">Note that \(r_\text{sph} \neq r\), so the horizon of a Kerr black hole is <em>not</em> at constant \(r_\text{sph}\).</p>
</li>
<li><p class="startli"><em>Oblate</em> <em>spheroidal</em> <em>coordinates</em>,</p>
<p class="formulaDsp">
\begin{align*} x &amp;= \sqrt{r^2 + a^2}\sin\vartheta\cos\phi,\\ y &amp;= \sqrt{r^2 + a^2}\sin\vartheta\sin\phi,\\ z &amp;= r\cos\vartheta. \end{align*}
</p>
<p class="startli">Notice that \(r\) is that defined in the Kerr-Schild form of the Kerr metric, so the horizon is at constant \(r\). (As it will be noted below, \(r\) corresponds to the Boyer-Lindquist radial coordinate.) Also, note that the azimuthal angle \(\phi\) is the same as the corresponding angle in spherical coordinates, whereas the zenithal angle \(\vartheta\) differs from the corresponding angle \(\theta\).</p>
</li>
<li><p class="startli"><em>Kerr</em> <em>coordinates</em> (sometimes also referred to as "Kerr-Schild coordinates"), defined by</p>
<p class="formulaDsp">
\begin{align*} x &amp;= (r \cos\varphi - a \sin\varphi)\sin\vartheta = \sqrt{r^2 + a^2}\sin\vartheta\cos\left(\varphi + \tan^{-1}(a/ r)\right),\\ y &amp;= (r \sin\varphi + a \cos\varphi)\sin\vartheta = \sqrt{r^2 + a^2}\sin\vartheta\sin\left(\varphi + \tan^{-1}(a/ r)\right),\\ z &amp;= r \cos\vartheta. \end{align*}
</p>
<p class="startli">These are the coordinates used in the <a class="el" href="classgr_1_1KerrSchildCoords.html" title="Contains helper functions for transforming tensors in Kerr spacetime to Kerr-Schild coordinates.">gr::KerrSchildCoords</a> class. Notice that \(r\) and \(\vartheta\) are the same as those in spheroidal coordinates, whereas the azimuthal angle \(\varphi \neq \phi\).</p>
<dl class="section note"><dt>Note</dt><dd>Kerr's original "advanced Eddington-Finkelstein" form of his metric is retrieved by performing the additional transformation \(t = u - r\). Note that Kerr's choice of the letter \(u\) for the time coordinate is not consistent with the convention of denoting the advanced time \(v = t + r\) (in flat space), and the retarded time \(u = t - r\) (in flat space). Finally, note that Kerr's original metric has the sign of \(a\) flipped.</dd></dl>
<p>The Kerr coordinates have been used in the hydro community to evolve the GRMHD equations. They are the intermediate step in getting the Kerr metric in Boyer-Lindquist coordinates. The relation between both is</p>
<p class="formulaDsp">
\begin{align*} dt_\text{BL} &amp;= dt - \frac{2M r\,dr}{r^2 - 2Mr + a^2}, \\ dr_\text{BL} &amp;= dr,\\ d\theta_\text{BL} &amp;= d\vartheta,\\ d\phi_\text{BL} &amp;= d\varphi - \frac{a\,dr}{r^2-2Mr + a^2}. \end{align*}
</p>
<p class="startli">The above transformation makes explicit that \(r\) is the Boyer-Lindquist radial coodinate, \( r = r_\text{BL}\). Likewise, \(\vartheta = \theta_\text{BL}\).</p>
<dl class="section note"><dt>Note</dt><dd>Sometimes (especially in the GRMHD community), the Kerr coordinates as defined above are referred to as "spherical Kerr-Schild" coordinates. These should not be confused with the true spherical coordinates defined in this documentation.</dd></dl>
<p>The Kerr metric in Kerr coodinates is sometimes used to write analytic initial data for hydro simulations. In this coordinate system, the metric takes the form</p>
<p class="formulaDsp">
\begin{align*} ds^2 &amp;= -(1 - B)\,dt^2 + (1 + B)\,dr^2 + \Sigma\,d\vartheta^2 + \left(r^2 + a^2 + B a^2\sin^2\vartheta\right)\sin^2\vartheta\,d\varphi^2\\ &amp;\quad + 2B\,dt\,dr - 2aB\sin^2\vartheta\,dt\,d\varphi - 2a\left(1 + B\right)\sin^2\vartheta\,dr\,d\varphi, \end{align*}
</p>
<p class="startli">where \(B = 2M r/ \Sigma\) and \(\Sigma = r^2 + a^2\cos^2\vartheta\). Using the additional relations</p>
<p class="formulaDsp">
\begin{align*} \sin\vartheta &amp;= \sqrt{\frac{x^2 + y^2}{r^2 + a^2}},\quad \cos\vartheta = \frac{z}{r},\\ \sin\varphi &amp;= \frac{y r - x a}{\sqrt{(x^2 + y^2)(r^2 + a^2)}},\quad \cos\varphi = \frac{x r + y a}{\sqrt{(x^2 + y^2)(r^2 + a^2)}}, \end{align*}
</p>
<p class="startli">the Jacobian of the transformation to Cartesian Kerr-Schild coordinates is</p>
<p class="formulaDsp">
\begin{align*} \dfrac{\partial(x, y, z)}{\partial(r, \vartheta, \varphi)} &amp;= \left(\begin{array}{ccc} \dfrac{xr + ya}{r^2 + a^2} &amp; \dfrac{xz}{r}\sqrt{\dfrac{r^2 + a^2}{x^2 + y^2}} &amp; -y\\ \dfrac{yr - ax}{r^2 + a^2} &amp; \dfrac{yz}{r}\sqrt{\dfrac{r^2 + a^2}{x^2 + y^2}} &amp; x\\ \dfrac{z}{r} &amp; - r\sqrt{\dfrac{x^2 + y^2}{r^2 + a^2}} &amp; 0 \end{array}\right), \end{align*}
</p>
<p class="startli">which can be used to transform tensors between both coordinate systems. </p>
</li>
</ul>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>src/PointwiseFunctions/GeneralRelativity/<a class="el" href="KerrSchildCoords_8hpp_source.html">KerrSchildCoords.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017 - 2020
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
