<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - 102d152bb208d020115bc267fd9f132d57025466 - /work/build/docs/xml/dev_guide_parallelization_foundations.xml</title>
  <link rel="stylesheet" type="text/css" href="../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title"> SpECTRE Documentation Coverage Report</td></tr>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../index.html">top level</a> - <a href="index.html">work/build/docs/xml</a> - dev_guide_parallelization_foundations.xml</td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
             <td class="headerItem">Commit:</td>
             <td class="headerValue"><a target="_blank" href="https://github.com/sxs-collaboration/spectre/commit/102d152bb208d020115bc267fd9f132d57025466">102d152bb208d020115bc267fd9f132d57025466</a></td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-01-05 20:09:09</td>
            <td></td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span><span class="lineCov">          1 : &lt;?xml version='1.0' encoding='UTF-8' standalone='no'?&gt;</span></a>
<a name="2"><span class="lineNum">       2 </span>            : &lt;doxygen xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;compound.xsd&quot; version=&quot;1.8.17&quot;&gt;</a>
<a name="3"><span class="lineNum">       3 </span>            :   &lt;compounddef id=&quot;dev_guide_parallelization_foundations&quot; kind=&quot;page&quot;&gt;</a>
<a name="4"><span class="lineNum">       4 </span>            :     &lt;compoundname&gt;dev_guide_parallelization_foundations&lt;/compoundname&gt;</a>
<a name="5"><span class="lineNum">       5 </span>            :     &lt;title&gt;Parallelization, Charm++, and Core Concepts&lt;/title&gt;</a>
<a name="6"><span class="lineNum">       6 </span>            :     &lt;tableofcontents&gt;</a>
<a name="7"><span class="lineNum">       7 </span>            :       &lt;tocsect&gt;</a>
<a name="8"><span class="lineNum">       8 </span>            :         &lt;name&gt;Introduction&lt;/name&gt;</a>
<a name="9"><span class="lineNum">       9 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_introduction&lt;/reference&gt;</a>
<a name="10"><span class="lineNum">      10 </span>            :     &lt;/tocsect&gt;</a>
<a name="11"><span class="lineNum">      11 </span>            :       &lt;tocsect&gt;</a>
<a name="12"><span class="lineNum">      12 </span>            :         &lt;name&gt;The Metavariables Class&lt;/name&gt;</a>
<a name="13"><span class="lineNum">      13 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_metavariables_class&lt;/reference&gt;</a>
<a name="14"><span class="lineNum">      14 </span>            :     &lt;/tocsect&gt;</a>
<a name="15"><span class="lineNum">      15 </span>            :       &lt;tocsect&gt;</a>
<a name="16"><span class="lineNum">      16 </span>            :         &lt;name&gt;Phases of an Execution&lt;/name&gt;</a>
<a name="17"><span class="lineNum">      17 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_phases_of_execution&lt;/reference&gt;</a>
<a name="18"><span class="lineNum">      18 </span>            :     &lt;/tocsect&gt;</a>
<a name="19"><span class="lineNum">      19 </span>            :       &lt;tocsect&gt;</a>
<a name="20"><span class="lineNum">      20 </span>            :         &lt;name&gt;The Algorithm&lt;/name&gt;</a>
<a name="21"><span class="lineNum">      21 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_core_algorithm&lt;/reference&gt;</a>
<a name="22"><span class="lineNum">      22 </span>            :     &lt;/tocsect&gt;</a>
<a name="23"><span class="lineNum">      23 </span>            :       &lt;tocsect&gt;</a>
<a name="24"><span class="lineNum">      24 </span>            :         &lt;name&gt;Parallel Components&lt;/name&gt;</a>
<a name="25"><span class="lineNum">      25 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_parallel_components&lt;/reference&gt;</a>
<a name="26"><span class="lineNum">      26 </span>            :     &lt;/tocsect&gt;</a>
<a name="27"><span class="lineNum">      27 </span>            :       &lt;tocsect&gt;</a>
<a name="28"><span class="lineNum">      28 </span>            :         &lt;name&gt;Actions&lt;/name&gt;</a>
<a name="29"><span class="lineNum">      29 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_actions&lt;/reference&gt;</a>
<a name="30"><span class="lineNum">      30 </span>            :     &lt;tableofcontents&gt;</a>
<a name="31"><span class="lineNum">      31 </span>            :       &lt;tocsect&gt;</a>
<a name="32"><span class="lineNum">      32 </span>            :         &lt;name&gt;1. Simple Actions&lt;/name&gt;</a>
<a name="33"><span class="lineNum">      33 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_simple_actions&lt;/reference&gt;</a>
<a name="34"><span class="lineNum">      34 </span>            :     &lt;/tocsect&gt;</a>
<a name="35"><span class="lineNum">      35 </span>            :       &lt;tocsect&gt;</a>
<a name="36"><span class="lineNum">      36 </span>            :         &lt;name&gt;2. Iterable Actions&lt;/name&gt;</a>
<a name="37"><span class="lineNum">      37 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_iterable_actions&lt;/reference&gt;</a>
<a name="38"><span class="lineNum">      38 </span>            :     &lt;/tocsect&gt;</a>
<a name="39"><span class="lineNum">      39 </span>            :       &lt;tocsect&gt;</a>
<a name="40"><span class="lineNum">      40 </span>            :         &lt;name&gt;3. Reduction Actions&lt;/name&gt;</a>
<a name="41"><span class="lineNum">      41 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_reduction_actions&lt;/reference&gt;</a>
<a name="42"><span class="lineNum">      42 </span>            :     &lt;/tocsect&gt;</a>
<a name="43"><span class="lineNum">      43 </span>            :     &lt;/tableofcontents&gt;</a>
<a name="44"><span class="lineNum">      44 </span>            :     &lt;/tocsect&gt;</a>
<a name="45"><span class="lineNum">      45 </span>            :       &lt;tocsect&gt;</a>
<a name="46"><span class="lineNum">      46 </span>            :         &lt;name&gt;Mutable items in the GlobalCache&lt;/name&gt;</a>
<a name="47"><span class="lineNum">      47 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md105&lt;/reference&gt;</a>
<a name="48"><span class="lineNum">      48 </span>            :     &lt;tableofcontents&gt;</a>
<a name="49"><span class="lineNum">      49 </span>            :       &lt;tocsect&gt;</a>
<a name="50"><span class="lineNum">      50 </span>            :         &lt;name&gt;1. Specification of mutable GlobalCache items&lt;/name&gt;</a>
<a name="51"><span class="lineNum">      51 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md106&lt;/reference&gt;</a>
<a name="52"><span class="lineNum">      52 </span>            :     &lt;/tocsect&gt;</a>
<a name="53"><span class="lineNum">      53 </span>            :       &lt;tocsect&gt;</a>
<a name="54"><span class="lineNum">      54 </span>            :         &lt;name&gt;2. Use of mutable GlobalCache items&lt;/name&gt;</a>
<a name="55"><span class="lineNum">      55 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md107&lt;/reference&gt;</a>
<a name="56"><span class="lineNum">      56 </span>            :     &lt;tableofcontents&gt;</a>
<a name="57"><span class="lineNum">      57 </span>            :       &lt;tocsect&gt;</a>
<a name="58"><span class="lineNum">      58 </span>            :         &lt;name&gt;1. Checking if the item is up-to-date&lt;/name&gt;</a>
<a name="59"><span class="lineNum">      59 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md108&lt;/reference&gt;</a>
<a name="60"><span class="lineNum">      60 </span>            :     &lt;/tocsect&gt;</a>
<a name="61"><span class="lineNum">      61 </span>            :       &lt;tocsect&gt;</a>
<a name="62"><span class="lineNum">      62 </span>            :         &lt;name&gt;2. Retrieving the item&lt;/name&gt;</a>
<a name="63"><span class="lineNum">      63 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md109&lt;/reference&gt;</a>
<a name="64"><span class="lineNum">      64 </span>            :     &lt;/tocsect&gt;</a>
<a name="65"><span class="lineNum">      65 </span>            :     &lt;/tableofcontents&gt;</a>
<a name="66"><span class="lineNum">      66 </span>            :     &lt;/tocsect&gt;</a>
<a name="67"><span class="lineNum">      67 </span>            :       &lt;tocsect&gt;</a>
<a name="68"><span class="lineNum">      68 </span>            :         &lt;name&gt;3. Modifying a mutable GlobalCache item&lt;/name&gt;</a>
<a name="69"><span class="lineNum">      69 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1autotoc_md110&lt;/reference&gt;</a>
<a name="70"><span class="lineNum">      70 </span>            :     &lt;/tocsect&gt;</a>
<a name="71"><span class="lineNum">      71 </span>            :     &lt;/tableofcontents&gt;</a>
<a name="72"><span class="lineNum">      72 </span>            :     &lt;/tocsect&gt;</a>
<a name="73"><span class="lineNum">      73 </span>            :       &lt;tocsect&gt;</a>
<a name="74"><span class="lineNum">      74 </span>            :         &lt;name&gt;Charm++ Node and Processor Level Initialization Functions&lt;/name&gt;</a>
<a name="75"><span class="lineNum">      75 </span>            :         &lt;reference&gt;dev_guide_parallelization_foundations_1dev_guide_parallelization_charm_node_processor_level_initialization&lt;/reference&gt;</a>
<a name="76"><span class="lineNum">      76 </span>            :     &lt;/tocsect&gt;</a>
<a name="77"><span class="lineNum">      77 </span>            :     &lt;/tableofcontents&gt;</a>
<a name="78"><span class="lineNum">      78 </span>            :     &lt;briefdescription&gt;</a>
<a name="79"><span class="lineNum">      79 </span>            :     &lt;/briefdescription&gt;</a>
<a name="80"><span class="lineNum">      80 </span>            :     &lt;detaileddescription&gt;</a>
<a name="81"><span class="lineNum">      81 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_introduction&quot;&gt;</a>
<a name="82"><span class="lineNum">      82 </span>            : &lt;title&gt;Introduction&lt;/title&gt;</a>
<a name="83"><span class="lineNum">      83 </span>            : &lt;para&gt;SpECTRE builds a layer on top of Charm++ that performs various safety checks and initialization for the user that can otherwise lead to difficult-to-debug undefined behavior. The central concept is what is called a Parallel Component. A Parallel Component is a struct with several type aliases that is used by SpECTRE to set up the Charm++ chares and allowed communication patterns. Parallel Components are input arguments to the compiler, which then writes the parallelization infrastructure that you requested for the executable. There is no restriction on the number of Parallel Components, though practically it is best to have around 10 at most.&lt;/para&gt;</a>
<a name="84"><span class="lineNum">      84 </span>            : &lt;para&gt;Here is an overview of what is described in detail in the sections below:&lt;/para&gt;</a>
<a name="85"><span class="lineNum">      85 </span>            : &lt;para&gt;&lt;itemizedlist&gt;</a>
<a name="86"><span class="lineNum">      86 </span>            : &lt;listitem&gt;&lt;para&gt;&lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_metavariables_class&quot; kindref=&quot;member&quot;&gt;Metavariables&lt;/ref&gt;: Provides high-level configuration to the compiler, e.g. the physical system to be simulated.&lt;/para&gt;</a>
<a name="87"><span class="lineNum">      87 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_phases_of_execution&quot; kindref=&quot;member&quot;&gt;Phases&lt;/ref&gt;: Defines distinct simulation phases separated by a global synchronization point, e.g. &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt;, &lt;computeroutput&gt;Evolve&lt;/computeroutput&gt; and &lt;computeroutput&gt;Exit&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="88"><span class="lineNum">      88 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_core_algorithm&quot; kindref=&quot;member&quot;&gt;Algorithm&lt;/ref&gt;: In each phase, repeatedly iterates over a list of actions until the current phase ends.&lt;/para&gt;</a>
<a name="89"><span class="lineNum">      89 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_parallel_components&quot; kindref=&quot;member&quot;&gt;Parallel component&lt;/ref&gt;: Maintains and executes its algorithm.&lt;/para&gt;</a>
<a name="90"><span class="lineNum">      90 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_actions&quot; kindref=&quot;member&quot;&gt;Action&lt;/ref&gt;: Performs a computational task, e.g. evaluating the right hand side of the time evolution equations. May require data to be received from another action potentially being executed on a different core or node.&lt;/para&gt;</a>
<a name="91"><span class="lineNum">      91 </span>            : &lt;/listitem&gt;&lt;/itemizedlist&gt;</a>
<a name="92"><span class="lineNum">      92 </span>            : &lt;/para&gt;</a>
<a name="93"><span class="lineNum">      93 </span>            : &lt;/sect1&gt;</a>
<a name="94"><span class="lineNum">      94 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_metavariables_class&quot;&gt;</a>
<a name="95"><span class="lineNum">      95 </span>            : &lt;title&gt;The Metavariables Class&lt;/title&gt;</a>
<a name="96"><span class="lineNum">      96 </span>            : &lt;para&gt;SpECTRE takes a different approach to input options passed to an executable than is common. SpECTRE not only reads an input file at runtime but also has many choices made at compile time. The compile time options are specified by what is referred to as the metavariables. What exactly the metavariables struct specifies depends on the executable, but all metavariables structs must specify the following:&lt;/para&gt;</a>
<a name="97"><span class="lineNum">      97 </span>            : &lt;para&gt;&lt;itemizedlist&gt;</a>
<a name="98"><span class="lineNum">      98 </span>            : &lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;help&lt;/computeroutput&gt;: a &lt;computeroutput&gt;static constexpr &lt;ref refid=&quot;namespaceOptions_1aa61c7f41f21afa7646811456f673be89&quot; kindref=&quot;member&quot;&gt;Options::String&lt;/ref&gt;&lt;/computeroutput&gt; that will be printed as part of the help message. It should describe the executable and basic usage of it, as well as any non-standard options that must be specified in the metavariables and their current values. An example of a help string for one of the testing executables is: &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;constexpr&lt;sp/&gt;&lt;ref refid=&quot;namespaceOptions_1aa61c7f41f21afa7646811456f673be89&quot; kindref=&quot;member&quot;&gt;Options::String&lt;/ref&gt;&lt;sp/&gt;help&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="99"><span class="lineNum">      99 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;An&lt;sp/&gt;executable&lt;sp/&gt;for&lt;sp/&gt;testing&lt;sp/&gt;the&lt;sp/&gt;core&lt;sp/&gt;functionality&lt;sp/&gt;of&lt;sp/&gt;the&lt;sp/&gt;Algorithm.&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="100"><span class="lineNum">     100 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Actions&lt;sp/&gt;that&lt;sp/&gt;do&lt;sp/&gt;not&lt;sp/&gt;perform&lt;sp/&gt;any&lt;sp/&gt;operations&lt;sp/&gt;(no-ops),&lt;sp/&gt;invoking&lt;sp/&gt;simple&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="101"><span class="lineNum">     101 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;actions,&lt;sp/&gt;mutating&lt;sp/&gt;data&lt;sp/&gt;in&lt;sp/&gt;the&lt;sp/&gt;DataBox,&lt;sp/&gt;adding&lt;sp/&gt;and&lt;sp/&gt;removing&lt;sp/&gt;items&lt;sp/&gt;from&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="102"><span class="lineNum">     102 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;the&lt;sp/&gt;DataBox,&lt;sp/&gt;receiving&lt;sp/&gt;data&lt;sp/&gt;from&lt;sp/&gt;other&lt;sp/&gt;parallel&lt;sp/&gt;components,&lt;sp/&gt;and&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="103"><span class="lineNum">     103 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;out-of-order&lt;sp/&gt;execution&lt;sp/&gt;of&lt;sp/&gt;Actions&lt;sp/&gt;are&lt;sp/&gt;all&lt;sp/&gt;tested.&lt;sp/&gt;All&lt;sp/&gt;tests&lt;sp/&gt;are&lt;sp/&gt;run&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="104"><span class="lineNum">     104 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;just&lt;sp/&gt;by&lt;sp/&gt;running&lt;sp/&gt;the&lt;sp/&gt;executable,&lt;sp/&gt;no&lt;sp/&gt;input&lt;sp/&gt;file&lt;sp/&gt;or&lt;sp/&gt;command&lt;sp/&gt;line&lt;sp/&gt;arguments&lt;sp/&gt;&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="105"><span class="lineNum">     105 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;are&lt;sp/&gt;required&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="106"><span class="lineNum">     106 </span>            : &lt;/programlisting&gt;&lt;/para&gt;</a>
<a name="107"><span class="lineNum">     107 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;component_list&lt;/computeroutput&gt;: a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of the parallel components (described below) that are to be created. Most evolution executables will have the &lt;computeroutput&gt;&lt;ref refid=&quot;structDgElementArray&quot; kindref=&quot;compound&quot;&gt;DgElementArray&lt;/ref&gt;&lt;/computeroutput&gt; parallel component listed. An example of a &lt;computeroutput&gt;component_list&lt;/computeroutput&gt; for one of the test executables is: &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;component_list&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;NoOpsComponent&amp;lt;TestMetavariables&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="108"><span class="lineNum">     108 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;MutateComponent&amp;lt;TestMetavariables&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="109"><span class="lineNum">     109 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;ReceiveComponent&amp;lt;TestMetavariables&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="110"><span class="lineNum">     110 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;AnyOrderComponent&amp;lt;TestMetavariables&amp;gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="111"><span class="lineNum">     111 </span>            : &lt;/programlisting&gt;&lt;/para&gt;</a>
<a name="112"><span class="lineNum">     112 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using const_global_cache_tags&lt;/computeroutput&gt;: a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags that are used to place const items in the GlobalCache. The alias may be omitted if the list is empty.&lt;/para&gt;</a>
<a name="113"><span class="lineNum">     113 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using mutable_global_cache_tags&lt;/computeroutput&gt;: a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags that are used to place mutable items in the GlobalCache. The alias may be omitted if the list is empty.&lt;/para&gt;</a>
<a name="114"><span class="lineNum">     114 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;Phase&lt;/computeroutput&gt;: an &lt;computeroutput&gt;enum class&lt;/computeroutput&gt; that must contain at least &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; and &lt;computeroutput&gt;Exit&lt;/computeroutput&gt;. Phases are described in the next section.&lt;/para&gt;</a>
<a name="115"><span class="lineNum">     115 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;determine_next_phase&lt;/computeroutput&gt;: a static function with the signature &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static&lt;sp/&gt;Phase&lt;sp/&gt;determine_next_phase(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="116"><span class="lineNum">     116 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;const&lt;sp/&gt;Phase&amp;amp;&lt;sp/&gt;current_phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="117"><span class="lineNum">     117 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;const&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;EvolutionMetavars&amp;gt;&amp;amp;&lt;sp/&gt;cache_proxy)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="118"><span class="lineNum">     118 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;noexcept;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="119"><span class="lineNum">     119 </span>            : &lt;/programlisting&gt; What this function does is described below in the discussion of &lt;ref refid=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_phases_of_execution&quot; kindref=&quot;member&quot;&gt;phases&lt;/ref&gt;.&lt;/para&gt;</a>
<a name="120"><span class="lineNum">     120 </span>            : &lt;/listitem&gt;&lt;/itemizedlist&gt;</a>
<a name="121"><span class="lineNum">     121 </span>            : &lt;/para&gt;</a>
<a name="122"><span class="lineNum">     122 </span>            : &lt;para&gt;There are also several optional members:&lt;/para&gt;</a>
<a name="123"><span class="lineNum">     123 </span>            : &lt;para&gt;&lt;itemizedlist&gt;</a>
<a name="124"><span class="lineNum">     124 </span>            : &lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;input_file&lt;/computeroutput&gt;: a &lt;computeroutput&gt;static constexpr &lt;ref refid=&quot;namespaceOptions_1aa61c7f41f21afa7646811456f673be89&quot; kindref=&quot;member&quot;&gt;Options::String&lt;/ref&gt;&lt;/computeroutput&gt; that is the default name of the input file that is to be read. This can be overridden at runtime by passing the &lt;computeroutput&gt;--input-file&lt;/computeroutput&gt; argument to the executable.&lt;/para&gt;</a>
<a name="125"><span class="lineNum">     125 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;ignore_unrecognized_command_line_options&lt;/computeroutput&gt;: a &lt;computeroutput&gt;static constexpr bool&lt;/computeroutput&gt; that defaults to &lt;computeroutput&gt;false&lt;/computeroutput&gt;. If set to &lt;computeroutput&gt;true&lt;/computeroutput&gt; then unrecognized command line options are ignored. Ignoring unrecognized options is generally only necessary for tests where arguments for the testing framework, &lt;ulink url=&quot;https://github.com/catchorg/Catch2/&quot;&gt;Catch&lt;/ulink&gt;, are passed to the executable.&lt;/para&gt;</a>
<a name="126"><span class="lineNum">     126 </span>            : &lt;/listitem&gt;&lt;/itemizedlist&gt;</a>
<a name="127"><span class="lineNum">     127 </span>            : &lt;/para&gt;</a>
<a name="128"><span class="lineNum">     128 </span>            : &lt;/sect1&gt;</a>
<a name="129"><span class="lineNum">     129 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_phases_of_execution&quot;&gt;</a>
<a name="130"><span class="lineNum">     130 </span>            : &lt;title&gt;Phases of an Execution&lt;/title&gt;</a>
<a name="131"><span class="lineNum">     131 </span>            : &lt;para&gt;Global synchronization points, where all cores wait for each other, are undesirable for scalability reasons. However, they are sometimes inevitable for algorithmic reasons. That is, in order to actually get a correct solution you need to have a global synchronization. SpECTRE executables can have multiple phases, where after each phase a global synchronization occurs. By global synchronization we mean that no parallel components are executing or have more tasks to execute: everything is waiting to be told what tasks to perform next.&lt;/para&gt;</a>
<a name="132"><span class="lineNum">     132 </span>            : &lt;para&gt;Every executable must have at least two phases, &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; and &lt;computeroutput&gt;Exit&lt;/computeroutput&gt;. The next phase is decided by the static member function &lt;computeroutput&gt;determine_next_phase&lt;/computeroutput&gt; in the metavariables. Currently this function has access to the phase that is ending, and also the global cache. In the future we will add support for receiving data from various components to allow for more complex decision making. Here is an example of a &lt;computeroutput&gt;determine_next_phase&lt;/computeroutput&gt; function and the &lt;computeroutput&gt;Phase&lt;/computeroutput&gt; enum class: &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;enum&lt;sp/&gt;class&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="133"><span class="lineNum">     133 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Initialization,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="134"><span class="lineNum">     134 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;NoOpsStart,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="135"><span class="lineNum">     135 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;NoOpsFinish,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="136"><span class="lineNum">     136 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;MutateStart,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="137"><span class="lineNum">     137 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;MutateFinish,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="138"><span class="lineNum">     138 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;ReceiveStart,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="139"><span class="lineNum">     139 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;ReceiveFinish,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="140"><span class="lineNum">     140 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;AnyOrderStart,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="141"><span class="lineNum">     141 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;AnyOrderFinish,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="142"><span class="lineNum">     142 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Exit&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="143"><span class="lineNum">     143 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="144"><span class="lineNum">     144 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="145"><span class="lineNum">     145 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase&lt;sp/&gt;determine_next_phase(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="146"><span class="lineNum">     146 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase&amp;amp;&lt;sp/&gt;current_phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="147"><span class="lineNum">     147 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="148"><span class="lineNum">     148 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;TestMetavariables&amp;gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache_proxy*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="149"><span class="lineNum">     149 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;switch&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(current_phase)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="150"><span class="lineNum">     150 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::Initialization:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="151"><span class="lineNum">     151 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::NoOpsStart;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="152"><span class="lineNum">     152 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::NoOpsStart:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="153"><span class="lineNum">     153 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::NoOpsFinish;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="154"><span class="lineNum">     154 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::NoOpsFinish:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="155"><span class="lineNum">     155 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::MutateStart;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="156"><span class="lineNum">     156 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::MutateStart:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="157"><span class="lineNum">     157 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::MutateFinish;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="158"><span class="lineNum">     158 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::MutateFinish:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="159"><span class="lineNum">     159 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::ReceiveStart;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="160"><span class="lineNum">     160 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::ReceiveStart:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="161"><span class="lineNum">     161 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::ReceiveFinish;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="162"><span class="lineNum">     162 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::ReceiveFinish:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="163"><span class="lineNum">     163 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::AnyOrderStart;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="164"><span class="lineNum">     164 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::AnyOrderStart:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="165"><span class="lineNum">     165 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::AnyOrderFinish;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="166"><span class="lineNum">     166 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::AnyOrderFinish:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="167"><span class="lineNum">     167 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;[[fallthrough]];&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="168"><span class="lineNum">     168 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;case&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::Exit:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="169"><span class="lineNum">     169 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::Exit;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="170"><span class="lineNum">     170 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;default&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;:&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="171"><span class="lineNum">     171 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ErrorHandlingGroup_1ga1d27028c1827976007fe9d29ad3a2f66&quot; kindref=&quot;member&quot;&gt;ERROR&lt;/ref&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Unknown&lt;sp/&gt;Phase...&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="172"><span class="lineNum">     172 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="173"><span class="lineNum">     173 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="174"><span class="lineNum">     174 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Phase::Exit;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="175"><span class="lineNum">     175 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="176"><span class="lineNum">     176 </span>            : &lt;/programlisting&gt; In contrast, an evolution executable might have phases &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt;, &lt;computeroutput&gt;SetInitialData&lt;/computeroutput&gt;, &lt;computeroutput&gt;Evolve&lt;/computeroutput&gt;, and &lt;computeroutput&gt;Exit&lt;/computeroutput&gt;, but have a similar &lt;computeroutput&gt;switch&lt;/computeroutput&gt; or &lt;computeroutput&gt;if-else&lt;/computeroutput&gt; logic in the &lt;computeroutput&gt;determine_next_phase&lt;/computeroutput&gt; function. The first phase that is entered is always &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt;. During the &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; phase the &lt;computeroutput&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt;&lt;/computeroutput&gt; is created, all non-array components are created, and empty array components are created. Next, the function &lt;computeroutput&gt;allocate_array_components_and_execute_initialization_phase&lt;/computeroutput&gt; is called which allocates the elements of each array component, and then starts the &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; phase on all parallel components. Once all parallel components&amp;apos; &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; phase is complete, the next phase is determined and the &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; function is called on all the parallel components.&lt;/para&gt;</a>
<a name="177"><span class="lineNum">     177 </span>            : &lt;para&gt;At the end of an execution the &lt;computeroutput&gt;Exit&lt;/computeroutput&gt; phase has the executable wait to make sure no parallel components are performing or need to perform any more tasks, and then exits. An example where this approach is important is if we are done evolving a system but still need to write data to disk. We do not want to exit the simulation until all data has been written to disk, even though we&amp;apos;ve reached the final time of the evolution.&lt;/para&gt;</a>
<a name="178"><span class="lineNum">     178 </span>            : &lt;para&gt;&lt;simplesect kind=&quot;warning&quot;&gt;&lt;para&gt;Currently dead-locks are treated as successful termination. In the future checks against deadlocks will be performed before terminating.&lt;/para&gt;</a>
<a name="179"><span class="lineNum">     179 </span>            : &lt;/simplesect&gt;</a>
<a name="180"><span class="lineNum">     180 </span>            : &lt;/para&gt;</a>
<a name="181"><span class="lineNum">     181 </span>            : &lt;/sect1&gt;</a>
<a name="182"><span class="lineNum">     182 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_core_algorithm&quot;&gt;</a>
<a name="183"><span class="lineNum">     183 </span>            : &lt;title&gt;The Algorithm&lt;/title&gt;</a>
<a name="184"><span class="lineNum">     184 </span>            : &lt;para&gt;Since most numerical algorithms repeat steps until some criterion such as the final time or convergence is met, SpECTRE&amp;apos;s parallel components are designed to do such iterations for the user. An Algorithm executes an ordered list of actions until one of the actions cannot be evaluated, typically because it is waiting on data from elsewhere. When an algorithm can no longer evaluate actions it passively waits by handing control back to Charm++. Once an algorithm receives data, typically done by having another parallel component call the &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; function, the algorithm will try again to execute the next action. If the algorithm is still waiting on more data then the algorithm will again return control to Charm++ and passively wait for more data. This is repeated until all required data is available. The actions that are iterated over by the algorithm are called iterable actions and are described below. Since the action list is phase dependent we refer to them generally as phase-dependent action lists (PDALs, pronounced &amp;quot;pedals&amp;quot;).&lt;/para&gt;</a>
<a name="185"><span class="lineNum">     185 </span>            : &lt;/sect1&gt;</a>
<a name="186"><span class="lineNum">     186 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_parallel_components&quot;&gt;</a>
<a name="187"><span class="lineNum">     187 </span>            : &lt;title&gt;Parallel Components&lt;/title&gt;</a>
<a name="188"><span class="lineNum">     188 </span>            : &lt;para&gt;Each Parallel Component struct must have the following type aliases:&lt;orderedlist&gt;</a>
<a name="189"><span class="lineNum">     189 </span>            : &lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using chare_type&lt;/computeroutput&gt; is set to one of:&lt;orderedlist&gt;</a>
<a name="190"><span class="lineNum">     190 </span>            : &lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Singleton&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Singleton&lt;/ref&gt;&lt;/computeroutput&gt;s have one object in the entire execution of the program.&lt;/para&gt;</a>
<a name="191"><span class="lineNum">     191 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Array&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Array&lt;/ref&gt;&lt;/computeroutput&gt;s hold zero or more elements, each of which is an object distributed to some core. An array can grow and shrink in size dynamically if need be and can also be bound to another array. A bound array has the same number of elements as the array it is bound to, and elements with the same ID are on the same core. See Charm++&amp;apos;s chare arrays for details.&lt;/para&gt;</a>
<a name="192"><span class="lineNum">     192 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Group&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Group&lt;/ref&gt;&lt;/computeroutput&gt;s are arrays with one element per core which are not able to be moved around between cores. These are typically useful for gathering data from array elements on their core, and then processing or reducing the data further. See &lt;ulink url=&quot;http://charm.cs.illinois.edu/help&quot;&gt;Charm++&amp;apos;s&lt;/ulink&gt; group chares for details.&lt;/para&gt;</a>
<a name="193"><span class="lineNum">     193 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Nodegroup&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Nodegroup&lt;/ref&gt;&lt;/computeroutput&gt;s are similar to groups except that there is one element per node. For Charm++ SMP (shared memory parallelism) builds, a node corresponds to the usual definition of a node on a supercomputer. However, for non-SMP builds nodes and cores are equivalent. We ensure that all entry method calls done through the Algorithm&amp;apos;s &lt;computeroutput&gt;simple_action&lt;/computeroutput&gt; and &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; functions are threadsafe. User controlled threading is possible by calling the non-entry method member function &lt;computeroutput&gt;threaded_action&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="194"><span class="lineNum">     194 </span>            : &lt;/listitem&gt;&lt;/orderedlist&gt;</a>
<a name="195"><span class="lineNum">     195 </span>            : &lt;/para&gt;</a>
<a name="196"><span class="lineNum">     196 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using metavariables&lt;/computeroutput&gt; is set to the Metavariables struct that stores the global metavariables. It is often easiest to have the Parallel Component struct have a template parameter &lt;computeroutput&gt;Metavariables&lt;/computeroutput&gt; that is the global metavariables struct. Examples of this technique are given below.&lt;/para&gt;</a>
<a name="197"><span class="lineNum">     197 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using phase_dependent_action_list&lt;/computeroutput&gt; is set to a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of &lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1PhaseActions&quot; kindref=&quot;compound&quot;&gt;Parallel::PhaseActions&lt;/ref&gt;&amp;lt;PhaseType, Phase, tmpl::list&amp;lt;Actions...&amp;gt;&amp;gt;&lt;/computeroutput&gt; where each &lt;computeroutput&gt;PhaseAction&lt;/computeroutput&gt; represents a PDAL that will be executed on the parallel component during the specified phase. The Actions are executed in the order that they are given in the &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt;s of the PDALs, but the phases need not be run in linear order. However, &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; types are constructed assuming the phases are performed from first in the &lt;computeroutput&gt;phase_dependent_action_list&lt;/computeroutput&gt; to the last. Simple actions (described below) can be executed in any phase. If there are no iterable actions in a phase then a &lt;computeroutput&gt;PhaseAction&lt;/computeroutput&gt; need not be specified for that phase. However, at least one &lt;computeroutput&gt;PhaseAction&lt;/computeroutput&gt;, even if it is empty, must be specified.&lt;/para&gt;</a>
<a name="198"><span class="lineNum">     198 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using initialization_tags&lt;/computeroutput&gt; which is a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of all the tags that will be inserted into the initial &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; of each component. These tags are &lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;s that have have a &lt;computeroutput&gt;using option_tags&lt;/computeroutput&gt; type alias and a static function &lt;computeroutput&gt;create_from_options&lt;/computeroutput&gt; (see the example below). This list can usually be constructed from the initialization actions of the component (i.e. the list of actions in the &lt;computeroutput&gt;PhaseAction&lt;/computeroutput&gt; list for the &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; phase) using the helper function &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga1e2e4c961e55eb461d66770393e4f45d&quot; kindref=&quot;member&quot;&gt;Parallel::get_initialization_tags&lt;/ref&gt;&lt;/computeroutput&gt; (see the examples of components below). Each initialization action may specify a type alias &lt;computeroutput&gt;using initialization_tags&lt;/computeroutput&gt; which are a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags that will be fetched from the db::DataBox by the action. All &lt;computeroutput&gt;initialization_tags&lt;/computeroutput&gt; are removed from the db::DataBox of the component at the end of the &lt;computeroutput&gt;Initialization&lt;/computeroutput&gt; phase, except for tags listed in a type alias &lt;computeroutput&gt;using initialization_tags_to_keep&lt;/computeroutput&gt; that may appear in each initialization action.&lt;/para&gt;</a>
<a name="199"><span class="lineNum">     199 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using const_global_cache_tags&lt;/computeroutput&gt; is set to a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags that are required by the &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; function of an array component, or simple actions called on the parallel component. These tags correspond to const items that are stored in the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; (of which there is one copy per Charm++ node). The alias can be omitted if the list is empty. (See &lt;computeroutput&gt;array_allocation_tags&lt;/computeroutput&gt; below for specifying tags needed for the &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; function, but will not be added to the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt;.)&lt;/para&gt;</a>
<a name="200"><span class="lineNum">     200 </span>            : &lt;/listitem&gt;&lt;listitem&gt;&lt;para&gt;&lt;computeroutput&gt;using mutable_global_cache_tags&lt;/computeroutput&gt; is set to a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags that correspond to mutable items that are stored in the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; (of which there is one copy per Charm++ core). The alias can be omitted if the list is empty.&lt;/para&gt;</a>
<a name="201"><span class="lineNum">     201 </span>            : &lt;/listitem&gt;&lt;/orderedlist&gt;</a>
<a name="202"><span class="lineNum">     202 </span>            : &lt;/para&gt;</a>
<a name="203"><span class="lineNum">     203 </span>            : &lt;para&gt;&lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;Array parallel components must also specify the type alias &lt;computeroutput&gt;using array_index&lt;/computeroutput&gt;, which is set to the type that indexes the Parallel Component Array. Charm++ allows arrays to be 1 through 6 dimensional or be indexed by a custom type. The Charm++ provided indexes are wrapped as &lt;computeroutput&gt;Parallel::ArrayIndex1D&lt;/computeroutput&gt; through &lt;computeroutput&gt;Parallel::ArrayIndex6D&lt;/computeroutput&gt;. When writing custom array indices, the &lt;ulink url=&quot;http://charm.cs.illinois.edu/help&quot;&gt;Charm++ manual&lt;/ulink&gt; tells you to write your own &lt;computeroutput&gt;CkArrayIndex&lt;/computeroutput&gt;, but we have written a general implementation that provides this functionality (see &lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1ArrayIndex&quot; kindref=&quot;compound&quot;&gt;Parallel::ArrayIndex&lt;/ref&gt;&lt;/computeroutput&gt;); all that you need to provide is a plain-old-data (&lt;ulink url=&quot;http://en.cppreference.com/w/cpp/concept/PODType&quot;&gt;POD&lt;/ulink&gt;) struct of the size of at most 3 integers.&lt;/para&gt;</a>
<a name="204"><span class="lineNum">     204 </span>            : &lt;/simplesect&gt;</a>
<a name="205"><span class="lineNum">     205 </span>            : Parallel array components have a static &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; function that is used to construct the elements of the array. The signature of the &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; functions must be: &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static&lt;sp/&gt;void&lt;sp/&gt;allocate_array(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="206"><span class="lineNum">     206 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;metavariables&amp;gt;&amp;amp;&lt;sp/&gt;global_cache,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="207"><span class="lineNum">     207 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;const&lt;sp/&gt;tuples::tagged_tuple_from_typelist&amp;lt;initialization_tags&amp;gt;&amp;amp;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="208"><span class="lineNum">     208 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;initialization_items)&lt;sp/&gt;noexcept;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="209"><span class="lineNum">     209 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; function is called by the Main parallel component when the execution starts and will typically insert elements into array parallel components. If the &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; function depends upon input options, the array component must specify a &lt;computeroutput&gt;using array_allocation_tags&lt;/computeroutput&gt; type alias that is a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of tags which are &lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;s that have have a &lt;computeroutput&gt;using option_tags&lt;/computeroutput&gt; type alias and a static function &lt;computeroutput&gt;create_from_options&lt;/computeroutput&gt;. An example is: &lt;programlisting filename=&quot;DistributedLinearSolverAlgorithmTestHelpers.hpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;LinearOperator&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="210"><span class="lineNum">     210 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;DenseMatrix&amp;lt;double, blaze::columnMajor&amp;gt;&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="211"><span class="lineNum">     211 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;option_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;OptionTags::LinearOperator&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="212"><span class="lineNum">     212 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="213"><span class="lineNum">     213 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;constexpr&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;pass_metavariables&lt;sp/&gt;=&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;false&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="214"><span class="lineNum">     214 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;DenseMatrix&amp;lt;double, blaze::columnMajor&amp;gt;&lt;/ref&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="215"><span class="lineNum">     215 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga30995e33b089e0daea78bcc497cc69af&quot; kindref=&quot;member&quot;&gt;create_from_options&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="216"><span class="lineNum">     216 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;classDenseMatrix&quot; kindref=&quot;compound&quot;&gt;DenseMatrix&amp;lt;double, blaze::columnMajor&amp;gt;&lt;/ref&gt;&amp;gt;&amp;amp;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="217"><span class="lineNum">     217 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;linear_operator)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="218"><span class="lineNum">     218 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;linear_operator;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="219"><span class="lineNum">     219 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="220"><span class="lineNum">     220 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="221"><span class="lineNum">     221 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;allocate_array&lt;/computeroutput&gt; functions of different array components are called in random order and so it is not safe to have them depend on each other.&lt;/para&gt;</a>
<a name="222"><span class="lineNum">     222 </span>            : &lt;para&gt;Each parallel component must also decide what to do in the different phases of the execution. This is controlled by an &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; function with signature: &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;static&lt;sp/&gt;void&lt;sp/&gt;execute_next_phase(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="223"><span class="lineNum">     223 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;const&lt;sp/&gt;typename&lt;sp/&gt;metavariables::Phase&lt;sp/&gt;next_phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="224"><span class="lineNum">     224 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;const&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;metavariables&amp;gt;&amp;amp;&lt;sp/&gt;global_cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="225"><span class="lineNum">     225 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;determine_next_phase&lt;/computeroutput&gt; function in the Metavariables determines the next phase, after which the &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; function gets called. The &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; function determines what the parallel component should do during the next phase. Typically the &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; function should just call &lt;computeroutput&gt;start_phase(phase)&lt;/computeroutput&gt; on the parallel component. In the future &lt;computeroutput&gt;execute_next_phase&lt;/computeroutput&gt; may be removed.&lt;/para&gt;</a>
<a name="226"><span class="lineNum">     226 </span>            : &lt;para&gt;An example of a singleton parallel component is: &lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;class&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="227"><span class="lineNum">     227 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;SingletonParallelComponent&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="228"><span class="lineNum">     228 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;chare_type&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Singleton&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Singleton&lt;/ref&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="229"><span class="lineNum">     229 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;metavariables&lt;sp/&gt;=&lt;sp/&gt;Metavariables;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="230"><span class="lineNum">     230 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;phase_dependent_action_list&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="231"><span class="lineNum">     231 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1PhaseActions&quot; kindref=&quot;compound&quot;&gt;Parallel::PhaseActions&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="232"><span class="lineNum">     232 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Metavariables::Phase::PerformSingletonAlgorithm,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="233"><span class="lineNum">     233 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;SingletonActions::CountReceives&amp;gt;&amp;gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="234"><span class="lineNum">     234 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;initialization_tags&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga1e2e4c961e55eb461d66770393e4f45d&quot; kindref=&quot;member&quot;&gt;Parallel::get_initialization_tags&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="235"><span class="lineNum">     235 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac5fb42f8eaf4da2707e32ed37ecf4e66&quot; kindref=&quot;member&quot;&gt;Parallel::get_initialization_actions_list&amp;lt;phase_dependent_action_list&amp;gt;&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="236"><span class="lineNum">     236 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="237"><span class="lineNum">     237 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;execute_next_phase(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="238"><span class="lineNum">     238 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase&lt;sp/&gt;next_phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="239"><span class="lineNum">     239 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;Metavariables&amp;gt;&amp;amp;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="240"><span class="lineNum">     240 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;global_cache)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="241"><span class="lineNum">     241 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;if&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(next_phase&lt;sp/&gt;==&lt;sp/&gt;Metavariables::Phase::PerformSingletonAlgorithm)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="242"><span class="lineNum">     242 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;local_cache&lt;sp/&gt;=&lt;sp/&gt;*(global_cache.ckLocalBranch());&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="243"><span class="lineNum">     243 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;SingletonParallelComponent&amp;gt;(local_cache)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="244"><span class="lineNum">     244 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;.start_phase(next_phase);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="245"><span class="lineNum">     245 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="246"><span class="lineNum">     246 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="247"><span class="lineNum">     247 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="248"><span class="lineNum">     248 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="249"><span class="lineNum">     249 </span>            : &lt;/programlisting&gt; An example of an array parallel component is: &lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;class&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="250"><span class="lineNum">     250 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;ArrayParallelComponent&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="251"><span class="lineNum">     251 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;chare_type&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1Algorithms_1_1Array&quot; kindref=&quot;compound&quot;&gt;Parallel::Algorithms::Array&lt;/ref&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="252"><span class="lineNum">     252 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;metavariables&lt;sp/&gt;=&lt;sp/&gt;Metavariables;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="253"><span class="lineNum">     253 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;phase_dependent_action_list&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="254"><span class="lineNum">     254 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1PhaseActions&quot; kindref=&quot;compound&quot;&gt;Parallel::PhaseActions&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="255"><span class="lineNum">     255 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Metavariables::Phase::Initialization,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="256"><span class="lineNum">     256 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;ArrayActions::Initialize&amp;gt;&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="257"><span class="lineNum">     257 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1PhaseActions&quot; kindref=&quot;compound&quot;&gt;Parallel::PhaseActions&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="258"><span class="lineNum">     258 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="259"><span class="lineNum">     259 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Metavariables::Phase::PerformArrayAlgorithm,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="260"><span class="lineNum">     260 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;ArrayActions::AddIntValue10,&lt;sp/&gt;ArrayActions::IncrementInt0,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="261"><span class="lineNum">     261 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;ArrayActions::RemoveInt0,&lt;sp/&gt;ArrayActions::SendToSingleton&amp;gt;&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="262"><span class="lineNum">     262 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1PhaseActions&quot; kindref=&quot;compound&quot;&gt;Parallel::PhaseActions&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="263"><span class="lineNum">     263 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Metavariables::Phase::FinalizeArray,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="264"><span class="lineNum">     264 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;ArrayActions::CheckWasUnpacked&amp;gt;&amp;gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="265"><span class="lineNum">     265 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;initialization_tags&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga1e2e4c961e55eb461d66770393e4f45d&quot; kindref=&quot;member&quot;&gt;Parallel::get_initialization_tags&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="266"><span class="lineNum">     266 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac5fb42f8eaf4da2707e32ed37ecf4e66&quot; kindref=&quot;member&quot;&gt;Parallel::get_initialization_actions_list&amp;lt;phase_dependent_action_list&amp;gt;&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="267"><span class="lineNum">     267 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;array_index&lt;sp/&gt;=&lt;sp/&gt;int;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="268"><span class="lineNum">     268 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="269"><span class="lineNum">     269 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;allocate_array(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="270"><span class="lineNum">     270 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;Metavariables&amp;gt;&amp;amp;&lt;sp/&gt;global_cache,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="271"><span class="lineNum">     271 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;tuples::tagged_tuple_from_typelist&amp;lt;initialization_tags&amp;gt;&amp;amp;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="272"><span class="lineNum">     272 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*initialization_items*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="273"><span class="lineNum">     273 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;local_cache&lt;sp/&gt;=&lt;sp/&gt;*(global_cache.ckLocalBranch());&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="274"><span class="lineNum">     274 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;array_proxy&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="275"><span class="lineNum">     275 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;ArrayParallelComponent&amp;gt;(local_cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="276"><span class="lineNum">     276 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="277"><span class="lineNum">     277 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;for&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;int&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;i&lt;sp/&gt;=&lt;sp/&gt;0,&lt;sp/&gt;which_proc&lt;sp/&gt;=&lt;sp/&gt;0,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="278"><span class="lineNum">     278 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga537d2cc78336566826c93c49f82746a8&quot; kindref=&quot;member&quot;&gt;number_of_procs&lt;/ref&gt;&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga537d2cc78336566826c93c49f82746a8&quot; kindref=&quot;member&quot;&gt;Parallel::number_of_procs&lt;/ref&gt;();&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="279"><span class="lineNum">     279 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;i&lt;sp/&gt;&amp;lt;&lt;sp/&gt;number_of_1d_array_elements;&lt;sp/&gt;++i)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="280"><span class="lineNum">     280 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;array_proxy[i].insert(global_cache,&lt;sp/&gt;{},&lt;sp/&gt;which_proc);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="281"><span class="lineNum">     281 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;which_proc&lt;sp/&gt;=&lt;sp/&gt;which_proc&lt;sp/&gt;+&lt;sp/&gt;1&lt;sp/&gt;==&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga537d2cc78336566826c93c49f82746a8&quot; kindref=&quot;member&quot;&gt;number_of_procs&lt;/ref&gt;&lt;sp/&gt;?&lt;sp/&gt;0&lt;sp/&gt;:&lt;sp/&gt;which_proc&lt;sp/&gt;+&lt;sp/&gt;1;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="282"><span class="lineNum">     282 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="283"><span class="lineNum">     283 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;array_proxy.doneInserting();&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="284"><span class="lineNum">     284 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="285"><span class="lineNum">     285 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="286"><span class="lineNum">     286 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;execute_next_phase(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="287"><span class="lineNum">     287 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables::Phase&lt;sp/&gt;next_phase,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="288"><span class="lineNum">     288 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::CProxy_GlobalCache&amp;lt;Metavariables&amp;gt;&amp;amp;&lt;sp/&gt;global_cache)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="289"><span class="lineNum">     289 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;local_cache&lt;sp/&gt;=&lt;sp/&gt;*(global_cache.ckLocalBranch());&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="290"><span class="lineNum">     290 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;if&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(next_phase&lt;sp/&gt;==&lt;sp/&gt;Metavariables::Phase::PerformArrayAlgorithm&lt;sp/&gt;or&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="291"><span class="lineNum">     291 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;next_phase&lt;sp/&gt;==&lt;sp/&gt;Metavariables::Phase::FinalizeArray)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="292"><span class="lineNum">     292 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;ArrayParallelComponent&amp;gt;(local_cache)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="293"><span class="lineNum">     293 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;.start_phase(next_phase);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="294"><span class="lineNum">     294 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="295"><span class="lineNum">     295 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="296"><span class="lineNum">     296 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="297"><span class="lineNum">     297 </span>            : &lt;/programlisting&gt;Elements are inserted into the array by using the Charm++ &lt;computeroutput&gt;insert&lt;/computeroutput&gt; member function of the CProxy for the array. The &lt;computeroutput&gt;insert&lt;/computeroutput&gt; function is documented in the Charm++ manual. In the above Array example &lt;computeroutput&gt;array_proxy&lt;/computeroutput&gt; is a &lt;computeroutput&gt;CProxy&lt;/computeroutput&gt; and so all the documentation for Charm++ array proxies applies. SpECTRE always creates empty arrays with the constructor and requires users to insert however many elements they want and on which cores they want them to be placed. Note that load balancing calls may result in array elements being moved.&lt;/para&gt;</a>
<a name="298"><span class="lineNum">     298 </span>            : &lt;/sect1&gt;</a>
<a name="299"><span class="lineNum">     299 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_actions&quot;&gt;</a>
<a name="300"><span class="lineNum">     300 </span>            : &lt;title&gt;Actions&lt;/title&gt;</a>
<a name="301"><span class="lineNum">     301 </span>            : &lt;para&gt;For those familiar with Charm++, actions should be thought of as effectively being entry methods. They are functions that can be invoked on a remote object (chare/parallel component) using a &lt;computeroutput&gt;CProxy&lt;/computeroutput&gt; (see the &lt;ulink url=&quot;http://charm.cs.illinois.edu/help&quot;&gt;Charm++ manual&lt;/ulink&gt;), which is retrieved from the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; using the parallel component struct and the &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gab0de6c4b4047a7eb4cbe45a33faa3f41&quot; kindref=&quot;member&quot;&gt;Parallel::get_parallel_component()&lt;/ref&gt;&lt;/computeroutput&gt; function. Actions are structs with a static &lt;computeroutput&gt;apply&lt;/computeroutput&gt; method and come in three variants: simple actions, iterable actions, and reduction actions. One important thing to note is that actions cannot return any data to the caller of the remote method. Instead, &amp;quot;returning&amp;quot; data must be done via callbacks or a callback-like mechanism.&lt;/para&gt;</a>
<a name="302"><span class="lineNum">     302 </span>            : &lt;para&gt;The simplest signature of an &lt;computeroutput&gt;apply&lt;/computeroutput&gt; method is for iterable actions: &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;InboxTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="303"><span class="lineNum">     303 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ActionList,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="304"><span class="lineNum">     304 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ParallelComponent&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="305"><span class="lineNum">     305 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/apply&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;apply&lt;/ref&gt;(db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;box,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="306"><span class="lineNum">     306 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;InboxTags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*inboxes*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="307"><span class="lineNum">     307 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="308"><span class="lineNum">     308 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="309"><span class="lineNum">     309 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ActionList&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*meta*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="310"><span class="lineNum">     310 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ParallelComponent*&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*meta*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="311"><span class="lineNum">     311 </span>            : &lt;/programlisting&gt;The return type is discussed at the end of each section describing a particular type of action. Simple actions can have additional arguments, do not receive the &lt;computeroutput&gt;inboxes&lt;/computeroutput&gt; or &lt;computeroutput&gt;ActionList&lt;/computeroutput&gt;, and take the &lt;computeroutput&gt;ParallelComponent&lt;/computeroutput&gt; as an explicit first template parameter. Reduction actions have the same signature as simple actions except that the additional arguments must be of the types reduced over. The &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; should be thought of as the member data of the parallel component while the actions are the member functions. The combination of a &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; and actions allows building up classes with arbitrary member data and methods using template parameters and invocation of actions. This approach allows us to eliminate the need for users to work with Charm++&amp;apos;s interface files, which can be error prone and difficult to use.&lt;/para&gt;</a>
<a name="312"><span class="lineNum">     312 </span>            : &lt;para&gt;The &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; is passed to each action so that the action has access to global data and is able to invoke actions on other parallel components. The &lt;computeroutput&gt;ParallelComponent&lt;/computeroutput&gt; template parameter is the tag of the parallel component that invoked the action. A proxy to the calling parallel component can then be retrieved from the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt;. The remote entry method invocations are slightly different for different types of actions, so they will be discussed below. However, one thing that is disallowed for all actions is calling an action locally from within an action on the same parallel component. Specifically,&lt;/para&gt;</a>
<a name="313"><span class="lineNum">     313 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmNestedApply1.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;local_parallel_component&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="314"><span class="lineNum">     314 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*Parallel::get_parallel_component&amp;lt;ParallelComponent&amp;gt;(cache).ckLocal();&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="315"><span class="lineNum">     315 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::simple_action&amp;lt;error_call_single_action_from_action&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="316"><span class="lineNum">     316 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;local_parallel_component);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="317"><span class="lineNum">     317 </span>            : &lt;/programlisting&gt; Here &lt;computeroutput&gt;ckLocal()&lt;/computeroutput&gt; is a Charm++ provided method that returns a pointer to the local (currently executing) parallel component. See the &lt;ulink url=&quot;http://charm.cs.illinois.edu/help&quot;&gt;Charm++ manual&lt;/ulink&gt; for more information. However, you are able to queue a new action to be executed later on the same parallel component by getting your own parallel component from the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; (&lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gab0de6c4b4047a7eb4cbe45a33faa3f41&quot; kindref=&quot;member&quot;&gt;Parallel::get_parallel_component&lt;/ref&gt;&amp;lt;ParallelComponent&amp;gt;(cache)&lt;/computeroutput&gt;). The difference between the two calls is that by calling an action through the parallel component you will first finish the series of actions you are in, then when they are complete Charm++ will call the next queued action.&lt;/para&gt;</a>
<a name="318"><span class="lineNum">     318 </span>            : &lt;para&gt;Array, group, and nodegroup parallel components can have actions invoked in two ways. First is a broadcast where the action is called on all elements of the array:&lt;/para&gt;</a>
<a name="319"><span class="lineNum">     319 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;group_parallel_component&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1gab0de6c4b4047a7eb4cbe45a33faa3f41&quot; kindref=&quot;member&quot;&gt;Parallel::get_parallel_component&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="320"><span class="lineNum">     320 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;GroupParallelComponent&amp;lt;Metavariables&amp;gt;&amp;gt;(cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="321"><span class="lineNum">     321 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::receive_data&amp;lt;Tags::IntReceiveTag&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="322"><span class="lineNum">     322 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;group_parallel_component,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="323"><span class="lineNum">     323 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;db::get&amp;lt;Tags::CountActionsCalled&amp;gt;(box)&lt;sp/&gt;+&lt;sp/&gt;100&lt;sp/&gt;*&lt;sp/&gt;array_index,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="324"><span class="lineNum">     324 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;db::get&amp;lt;Tags::CountActionsCalled&amp;gt;(box));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="325"><span class="lineNum">     325 </span>            : &lt;/programlisting&gt; The second case is invoking an action on a specific array element by using the array element&amp;apos;s index. The below example shows how a broadcast would be done manually by looping over all elements in the array:&lt;/para&gt;</a>
<a name="326"><span class="lineNum">     326 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;array_parallel_component&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="327"><span class="lineNum">     327 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;ArrayParallelComponent&amp;lt;Metavariables&amp;gt;&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="328"><span class="lineNum">     328 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="329"><span class="lineNum">     329 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;for&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;int&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;i&lt;sp/&gt;=&lt;sp/&gt;0;&lt;sp/&gt;i&lt;sp/&gt;&amp;lt;&lt;sp/&gt;number_of_1d_array_elements;&lt;sp/&gt;++i)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="330"><span class="lineNum">     330 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::receive_data&amp;lt;Tags::IntReceiveTag&amp;gt;(array_parallel_component[i],&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="331"><span class="lineNum">     331 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;0,&lt;sp/&gt;101,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;true&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="332"><span class="lineNum">     332 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="333"><span class="lineNum">     333 </span>            : &lt;/programlisting&gt; Note that in general you will not know what all the elements in the array are and so a broadcast is the correct method of sending data to or invoking an action on all elements of an array parallel component.&lt;/para&gt;</a>
<a name="334"><span class="lineNum">     334 </span>            : &lt;para&gt;The &lt;computeroutput&gt;array_index&lt;/computeroutput&gt; argument passed to all &lt;computeroutput&gt;apply&lt;/computeroutput&gt; methods is the index into the parallel component array. If the parallel component is not an array the value and type of &lt;computeroutput&gt;array_index&lt;/computeroutput&gt; is implementation defined and cannot be relied on. The &lt;computeroutput&gt;ActionList&lt;/computeroutput&gt; type is the &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; of iterable actions in the current phase. That is, it is equal to the &lt;computeroutput&gt;action_list&lt;/computeroutput&gt; type alias in the current PDAL.&lt;/para&gt;</a>
<a name="335"><span class="lineNum">     335 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_simple_actions&quot;&gt;</a>
<a name="336"><span class="lineNum">     336 </span>            : &lt;title&gt;1. Simple Actions&lt;/title&gt;</a>
<a name="337"><span class="lineNum">     337 </span>            : &lt;para&gt;Simple actions are designed to be called in a similar fashion to member functions of classes. They are the direct analog of entry methods in Charm++ except that the member data is stored in the &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; that is passed in as the first argument. A simple action must return void but can use &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga258d81b1a545746fb8e039349da6baae&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt; to change values of items in the &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; if the &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; is taken as a non-const reference. In some cases you will need specific items to be in the &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt; otherwise the action won&amp;apos;t compile. To restrict which &lt;computeroutput&gt;db::DataBox&lt;/computeroutput&gt;es can be passed you should use &lt;computeroutput&gt;Requires&lt;/computeroutput&gt; in the action&amp;apos;s &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function template parameter list. For example, &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ParallelComponent,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;DbTags,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="338"><span class="lineNum">     338 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="339"><span class="lineNum">     339 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__UtilitiesGroup_1ga084d535585c18d4e80f8ec6052d341a3&quot; kindref=&quot;member&quot;&gt;Requires&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;group__UtilitiesGroup_1ga8a328cb983ebb1947b0eb9d924f40253&quot; kindref=&quot;member&quot;&gt;tmpl2::flat_any_v&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="340"><span class="lineNum">     340 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::is_same_v&amp;lt;CountActionsCalled,&lt;sp/&gt;DbTags&amp;gt;...&amp;gt;&amp;gt;&lt;sp/&gt;=&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;nullptr&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="341"><span class="lineNum">     341 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/apply&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;apply&lt;/ref&gt;(db::DataBox&amp;lt;tmpl::list&amp;lt;DbTags...&amp;gt;&amp;gt;&amp;amp;&lt;sp/&gt;box,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="342"><span class="lineNum">     342 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="343"><span class="lineNum">     343 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="344"><span class="lineNum">     344 </span>            : &lt;/programlisting&gt;where the conditional checks if any element in the parameter pack &lt;computeroutput&gt;DbTags&lt;/computeroutput&gt; is &lt;computeroutput&gt;CountActionsCalled&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="345"><span class="lineNum">     345 </span>            : &lt;para&gt;A simple action that does not take any arguments can be called using a &lt;computeroutput&gt;CProxy&lt;/computeroutput&gt; from the &lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&lt;/ref&gt; as follows:&lt;/para&gt;</a>
<a name="346"><span class="lineNum">     346 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::simple_action&amp;lt;add_remove_test::finalize&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="347"><span class="lineNum">     347 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;MutateComponent&amp;gt;(local_cache));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="348"><span class="lineNum">     348 </span>            : &lt;/programlisting&gt; If the simple action takes arguments then the arguments must be as follows:&lt;/para&gt;</a>
<a name="349"><span class="lineNum">     349 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmNodelock.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::simple_action&amp;lt;nodegroup_receive&amp;gt;(local_nodegroup,&lt;sp/&gt;array_index);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="350"><span class="lineNum">     350 </span>            : &lt;/programlisting&gt; &lt;/para&gt;</a>
<a name="351"><span class="lineNum">     351 </span>            : &lt;/sect2&gt;</a>
<a name="352"><span class="lineNum">     352 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_iterable_actions&quot;&gt;</a>
<a name="353"><span class="lineNum">     353 </span>            : &lt;title&gt;2. Iterable Actions&lt;/title&gt;</a>
<a name="354"><span class="lineNum">     354 </span>            : &lt;para&gt;Actions in the algorithm that are part of the current PDAL are executed one after the other until one of them cannot be evaluated. Iterable actions may have an &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; method that returns &lt;computeroutput&gt;true&lt;/computeroutput&gt; or &lt;computeroutput&gt;false&lt;/computeroutput&gt; depending on whether or not the action is ready to be evaluated. If no &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; method is provided then the action is assumed to be ready to be evaluated. The &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; method typically checks that required data from other parallel components has been received. For example, it may check that all data from neighboring elements has arrived to be able to continue integrating in time. The signature of an &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; method must be:&lt;/para&gt;</a>
<a name="355"><span class="lineNum">     355 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;InboxTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="356"><span class="lineNum">     356 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="357"><span class="lineNum">     357 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;namespaceActionTesting_1a47e1c0b16f47574d2242b7c02732a69c&quot; kindref=&quot;member&quot;&gt;is_ready&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="358"><span class="lineNum">     358 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;box,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="359"><span class="lineNum">     359 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;InboxTags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;inboxes,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="360"><span class="lineNum">     360 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="361"><span class="lineNum">     361 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="362"><span class="lineNum">     362 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;inboxes&lt;/computeroutput&gt; is a collection of the tags passed to &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; and are specified in the iterable actions member type alias &lt;computeroutput&gt;inbox_tags&lt;/computeroutput&gt;, which must be a &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt;. The &lt;computeroutput&gt;inbox_tags&lt;/computeroutput&gt; must have two member type aliases, a &lt;computeroutput&gt;temporal_id&lt;/computeroutput&gt; which is used to identify when the data was sent, and a &lt;computeroutput&gt;type&lt;/computeroutput&gt; which is the type of the data to be stored in the &lt;computeroutput&gt;inboxes&lt;/computeroutput&gt;. The types are typically a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&lt;/ref&gt;&amp;lt;temporal_id, DATA&amp;gt;&lt;/computeroutput&gt;. In the discussed scenario of waiting for neighboring elements to send their data the &lt;computeroutput&gt;DATA&lt;/computeroutput&gt; type would be a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&lt;/ref&gt;&amp;lt;TheElementId, DataSent&amp;gt;&lt;/computeroutput&gt;. Inbox tags must also specify a &lt;computeroutput&gt;static void insert_into_inbox()&lt;/computeroutput&gt; function. For example,&lt;/para&gt;</a>
<a name="363"><span class="lineNum">     363 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;IntReceiveTag&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="364"><span class="lineNum">     364 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;temporal_id&lt;sp/&gt;=&lt;sp/&gt;int;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="365"><span class="lineNum">     365 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&amp;lt;temporal_id, std::unordered_multiset&amp;lt;int&amp;gt;&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="366"><span class="lineNum">     366 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="367"><span class="lineNum">     367 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Inbox,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ReceiveDataType&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="368"><span class="lineNum">     368 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;insert_into_inbox(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;Inbox*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;inbox,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="369"><span class="lineNum">     369 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;temporal_id&amp;amp;&lt;sp/&gt;temporal_id_v,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="370"><span class="lineNum">     370 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;ReceiveDataType&amp;amp;&amp;amp;&lt;sp/&gt;data)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="371"><span class="lineNum">     371 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;(*inbox)[temporal_id_v].insert(std::forward&amp;lt;ReceiveDataType&amp;gt;(data));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="372"><span class="lineNum">     372 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="373"><span class="lineNum">     373 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="374"><span class="lineNum">     374 </span>            : &lt;/programlisting&gt; For common types of &lt;computeroutput&gt;DATA&lt;/computeroutput&gt;, such as a &lt;computeroutput&gt;map&lt;/computeroutput&gt;, a data structure with an &lt;computeroutput&gt;insert&lt;/computeroutput&gt; function, a data structure with a &lt;computeroutput&gt;push_back&lt;/computeroutput&gt; function, or copy/move assignment that is used to insert the received data, inserters are available in &lt;computeroutput&gt;&lt;ref refid=&quot;namespaceParallel_1_1InboxInserters&quot; kindref=&quot;compound&quot;&gt;Parallel::InboxInserters&lt;/ref&gt;&lt;/computeroutput&gt;. For example, there is &lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1InboxInserters_1_1Map&quot; kindref=&quot;compound&quot;&gt;Parallel::InboxInserters::Map&lt;/ref&gt;&lt;/computeroutput&gt; for &lt;computeroutput&gt;map&lt;/computeroutput&gt; data structures. The inbox tag can inherit publicly off the inserters to gain the required insertion capabilities:&lt;/para&gt;</a>
<a name="375"><span class="lineNum">     375 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;IntReceiveTag&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="376"><span class="lineNum">     376 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;:&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;public&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;structParallel_1_1InboxInserters_1_1MemberInsert&quot; kindref=&quot;compound&quot;&gt;Parallel::InboxInserters::MemberInsert&lt;/ref&gt;&amp;lt;IntReceiveTag&amp;gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="377"><span class="lineNum">     377 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;temporal_id&lt;sp/&gt;=&lt;sp/&gt;TestAlgorithmArrayInstance;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="378"><span class="lineNum">     378 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&amp;lt;temporal_id, std::unordered_multiset&amp;lt;int&amp;gt;&lt;/ref&gt;&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="379"><span class="lineNum">     379 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="380"><span class="lineNum">     380 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;inbox_tags&lt;/computeroutput&gt; type alias for the action is:&lt;/para&gt;</a>
<a name="381"><span class="lineNum">     381 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;inbox_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;Tags::IntReceiveTag&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="382"><span class="lineNum">     382 </span>            : &lt;/programlisting&gt; and the &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; function is:&lt;/para&gt;</a>
<a name="383"><span class="lineNum">     383 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;InboxTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="384"><span class="lineNum">     384 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="385"><span class="lineNum">     385 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;namespaceActionTesting_1a47e1c0b16f47574d2242b7c02732a69c&quot; kindref=&quot;member&quot;&gt;is_ready&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="386"><span class="lineNum">     386 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*box*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="387"><span class="lineNum">     387 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;InboxTags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;inboxes,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="388"><span class="lineNum">     388 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="389"><span class="lineNum">     389 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="390"><span class="lineNum">     390 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;int_receives&lt;sp/&gt;=&lt;sp/&gt;tuples::get&amp;lt;Tags::IntReceiveTag&amp;gt;(inboxes);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="391"><span class="lineNum">     391 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;int_receives.size()&lt;sp/&gt;==&lt;sp/&gt;70;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="392"><span class="lineNum">     392 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="393"><span class="lineNum">     393 </span>            : &lt;/programlisting&gt; Once all of the &lt;computeroutput&gt;int&lt;/computeroutput&gt;s have been received, the iterable action is executed, not before.&lt;/para&gt;</a>
<a name="394"><span class="lineNum">     394 </span>            : &lt;para&gt;&lt;simplesect kind=&quot;warning&quot;&gt;&lt;para&gt;It is the responsibility of the iterable action to remove data from the inboxes that will no longer be needed. The removal of unneeded data should be done in the &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function.&lt;/para&gt;</a>
<a name="395"><span class="lineNum">     395 </span>            : &lt;/simplesect&gt;</a>
<a name="396"><span class="lineNum">     396 </span>            : Iterable actions can change the type of the db::DataBox by adding or removing elements/tags from the db::DataBox. The only requirement is that the last action in each PDAL returns a db::DataBox that is the same type for each iteration. Iterable actions can also request that the algorithm no longer be executed, and control which action in the current PDAL will be executed next. This is all done via the return value from the &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function. The &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function for iterable actions must return a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; of one, two, or three elements. The first element of the tuple is the new db::DataBox, which can be the same as the type passed in or a db::DataBox with different tags. Most iterable actions will simply return:&lt;/para&gt;</a>
<a name="397"><span class="lineNum">     397 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;std::forward_as_tuple(std::move(box));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="398"><span class="lineNum">     398 </span>            : &lt;/programlisting&gt; By returning the db::DataBox as a reference in a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; we avoid any unnecessary copying of the db::DataBox. The second argument is an optional bool, and controls whether or not the algorithm is terminated. If the bool is &lt;computeroutput&gt;true&lt;/computeroutput&gt; then the algorithm is terminated, by default it is &lt;computeroutput&gt;false&lt;/computeroutput&gt;. Here is an example of how to return a db::DataBox with the same type that is passed in and also terminate the algorithm:&lt;/para&gt;</a>
<a name="399"><span class="lineNum">     399 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;db::DataBox&amp;lt;DbTags&amp;gt;&lt;/ref&gt;&amp;amp;&amp;amp;,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;gt;(std::move(box),&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;true&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="400"><span class="lineNum">     400 </span>            : &lt;/programlisting&gt; Notice that we again return a reference to the db::DataBox, which is done to avoid any copying. After an algorithm has been terminated it can be restarted by passing &lt;computeroutput&gt;false&lt;/computeroutput&gt; to the &lt;computeroutput&gt;set_terminate&lt;/computeroutput&gt; method or by calling &lt;computeroutput&gt;receive_data(..., true)&lt;/computeroutput&gt;. Since the order in which messages are received is undefined in most cases the &lt;computeroutput&gt;receive_data(..., true)&lt;/computeroutput&gt; call should be used to restart the algorithm.&lt;/para&gt;</a>
<a name="401"><span class="lineNum">     401 </span>            : &lt;para&gt;The third optional element in the returned &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; is a &lt;computeroutput&gt;size_t&lt;/computeroutput&gt; whose value corresponds to the index of the action to be called next in the PDAL. The metafunction &lt;computeroutput&gt;tmpl::index_of&amp;lt;list, element&amp;gt;&lt;/computeroutput&gt; can be used to get an &lt;computeroutput&gt;tmpl::integral_constant&lt;/computeroutput&gt; with the value of the index of the element &lt;computeroutput&gt;element&lt;/computeroutput&gt; in the typelist &lt;computeroutput&gt;list&lt;/computeroutput&gt;. For example,&lt;/para&gt;</a>
<a name="402"><span class="lineNum">     402 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;decltype(std::move(box)), bool, size_t&amp;gt;&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="403"><span class="lineNum">     403 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::move(box),&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;true&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="404"><span class="lineNum">     404 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::index_of&amp;lt;ActionList,&lt;sp/&gt;iterate_increment_int0&amp;gt;::value&lt;sp/&gt;+&lt;sp/&gt;1);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="405"><span class="lineNum">     405 </span>            : &lt;/programlisting&gt; Again a reference to the db::DataBox is returned, while the termination &lt;computeroutput&gt;bool&lt;/computeroutput&gt; and next action &lt;computeroutput&gt;size_t&lt;/computeroutput&gt; are returned by value. The metafunction call &lt;computeroutput&gt;tmpl::index_of&amp;lt;ActionList, iterate_increment_int0&amp;gt;::value&lt;/computeroutput&gt; returns a &lt;computeroutput&gt;size_t&lt;/computeroutput&gt; whose value is that of the action &lt;computeroutput&gt;iterate_increment_int0&lt;/computeroutput&gt; in the PDAL. The indexing of actions in the PDAL starts at &lt;computeroutput&gt;0&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="406"><span class="lineNum">     406 </span>            : &lt;para&gt;Iterable actions are invoked as part of the algorithm and so the only way to request they be invoked is by having the algorithm run on the parallel component. The algorithm can be explicitly evaluated in a new phase by calling &lt;computeroutput&gt;start_phase(Phase::TheCurrentPhase)&lt;/computeroutput&gt;:&lt;/para&gt;</a>
<a name="407"><span class="lineNum">     407 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;NoOpsComponent&amp;gt;(local_cache)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="408"><span class="lineNum">     408 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;.start_phase(next_phase);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="409"><span class="lineNum">     409 </span>            : &lt;/programlisting&gt; Alternatively, to evaluate the algorithm without changing phases the &lt;computeroutput&gt;perform_algorithm()&lt;/computeroutput&gt; method can be used.&lt;/para&gt;</a>
<a name="410"><span class="lineNum">     410 </span>            : &lt;para&gt;By passing &lt;computeroutput&gt;true&lt;/computeroutput&gt; to &lt;computeroutput&gt;perform_algorithm&lt;/computeroutput&gt; the algorithm will be restarted if it was terminated.&lt;/para&gt;</a>
<a name="411"><span class="lineNum">     411 </span>            : &lt;para&gt;The algorithm is also evaluated by calling the &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; function, either on an entire array or singleton (this does a broadcast), or an on individual element of the array. Here is an example of a broadcast call:&lt;/para&gt;</a>
<a name="412"><span class="lineNum">     412 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;group_parallel_component&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1gab0de6c4b4047a7eb4cbe45a33faa3f41&quot; kindref=&quot;member&quot;&gt;Parallel::get_parallel_component&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="413"><span class="lineNum">     413 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;GroupParallelComponent&amp;lt;Metavariables&amp;gt;&amp;gt;(cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="414"><span class="lineNum">     414 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::receive_data&amp;lt;Tags::IntReceiveTag&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="415"><span class="lineNum">     415 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;group_parallel_component,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="416"><span class="lineNum">     416 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;db::get&amp;lt;Tags::CountActionsCalled&amp;gt;(box)&lt;sp/&gt;+&lt;sp/&gt;100&lt;sp/&gt;*&lt;sp/&gt;array_index,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="417"><span class="lineNum">     417 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;db::get&amp;lt;Tags::CountActionsCalled&amp;gt;(box));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="418"><span class="lineNum">     418 </span>            : &lt;/programlisting&gt; and of calling individual elements:&lt;/para&gt;</a>
<a name="419"><span class="lineNum">     419 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;array_parallel_component&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="420"><span class="lineNum">     420 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::get_parallel_component&amp;lt;ArrayParallelComponent&amp;lt;Metavariables&amp;gt;&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="421"><span class="lineNum">     421 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="422"><span class="lineNum">     422 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;for&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;int&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;i&lt;sp/&gt;=&lt;sp/&gt;0;&lt;sp/&gt;i&lt;sp/&gt;&amp;lt;&lt;sp/&gt;number_of_1d_array_elements;&lt;sp/&gt;++i)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="423"><span class="lineNum">     423 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::receive_data&amp;lt;Tags::IntReceiveTag&amp;gt;(array_parallel_component[i],&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="424"><span class="lineNum">     424 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;0,&lt;sp/&gt;101,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;true&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="425"><span class="lineNum">     425 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="426"><span class="lineNum">     426 </span>            : &lt;/programlisting&gt; The &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; function always takes a &lt;computeroutput&gt;ReceiveTag&lt;/computeroutput&gt;, which is set in the actions &lt;computeroutput&gt;inbox_tags&lt;/computeroutput&gt; type alias as described above. The first argument is the temporal identifier, and the second is the data to be sent.&lt;/para&gt;</a>
<a name="427"><span class="lineNum">     427 </span>            : &lt;para&gt;Normally when remote functions are invoked they go through the Charm++ runtime system, which adds some overhead. The &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; function tries to elide the call to the Charm++ RTS for calls into array components. Charm++ refers to these types of remote calls as &amp;quot;inline entry methods&amp;quot;. With the Charm++ method of eliding the RTS, the code becomes susceptible to stack overflows because of infinite recursion. The &lt;computeroutput&gt;receive_data&lt;/computeroutput&gt; function is limited to at most 64 RTS elided calls, though in practice reaching this limit is rare. When the limit is reached the remote method invocation is done through the RTS instead of being elided.&lt;/para&gt;</a>
<a name="428"><span class="lineNum">     428 </span>            : &lt;/sect2&gt;</a>
<a name="429"><span class="lineNum">     429 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_reduction_actions&quot;&gt;</a>
<a name="430"><span class="lineNum">     430 </span>            : &lt;title&gt;3. Reduction Actions&lt;/title&gt;</a>
<a name="431"><span class="lineNum">     431 </span>            : &lt;para&gt;Finally, there are reduction actions which are used when reducing data over an array. For example, you may want to know the sum of a &lt;computeroutput&gt;int&lt;/computeroutput&gt; from every element in the array. You can do this as follows:&lt;/para&gt;</a>
<a name="432"><span class="lineNum">     432 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmReduction.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::ReductionData&amp;lt;Parallel::ReductionDatum&amp;lt;int,&lt;sp/&gt;funcl::Plus&amp;lt;&amp;gt;&amp;gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="433"><span class="lineNum">     433 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;my_send_int{array_index};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="434"><span class="lineNum">     434 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::contribute_to_reduction&amp;lt;ProcessReducedSumOfInts&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="435"><span class="lineNum">     435 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;my_send_int,&lt;sp/&gt;my_proxy,&lt;sp/&gt;singleton_proxy);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="436"><span class="lineNum">     436 </span>            : &lt;/programlisting&gt; This reduces over the parallel component &lt;computeroutput&gt;ArrayParallelComponent&amp;lt;Metavariables&amp;gt;&lt;/computeroutput&gt;, reduces to the parallel component &lt;computeroutput&gt;SingletonParallelComponent&amp;lt;Metavariables&amp;gt;&lt;/computeroutput&gt;, and calls the action &lt;computeroutput&gt;ProcessReducedSumOfInts&lt;/computeroutput&gt; after the reduction has been performed. The reduction action is:&lt;/para&gt;</a>
<a name="437"><span class="lineNum">     437 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmReduction.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;ProcessReducedSumOfInts&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="438"><span class="lineNum">     438 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ParallelComponent,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="439"><span class="lineNum">     439 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="440"><span class="lineNum">     440 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/apply&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;apply&lt;/ref&gt;(db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*box*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="441"><span class="lineNum">     441 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="442"><span class="lineNum">     442 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="443"><span class="lineNum">     443 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;int&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;value)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="444"><span class="lineNum">     444 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(number_of_1d_array_elements&lt;sp/&gt;*&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="445"><span class="lineNum">     445 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;(number_of_1d_array_elements&lt;sp/&gt;-&lt;sp/&gt;1)&lt;sp/&gt;/&lt;sp/&gt;2&lt;sp/&gt;==&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="446"><span class="lineNum">     446 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;value);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="447"><span class="lineNum">     447 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="448"><span class="lineNum">     448 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="449"><span class="lineNum">     449 </span>            : &lt;/programlisting&gt; As you can see, the last argument to the &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function is of type &lt;computeroutput&gt;int&lt;/computeroutput&gt;, and is the reduced value.&lt;/para&gt;</a>
<a name="450"><span class="lineNum">     450 </span>            : &lt;para&gt;You can also broadcast the result back to an array, even yourself. For example,&lt;/para&gt;</a>
<a name="451"><span class="lineNum">     451 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmReduction.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::contribute_to_reduction&amp;lt;ProcessReducedSumOfInts&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="452"><span class="lineNum">     452 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;my_send_int,&lt;sp/&gt;my_proxy,&lt;sp/&gt;array_proxy);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="453"><span class="lineNum">     453 </span>            : &lt;/programlisting&gt; It is often necessary to reduce custom data types, such as &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&lt;/computeroutput&gt; or &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&lt;/ref&gt;&lt;/computeroutput&gt;. Charm++ supports such custom reductions, and so does our layer on top of Charm++. Custom reductions require one additional step to calling &lt;computeroutput&gt;contribute_to_reduction&lt;/computeroutput&gt;, which is writing a reduction function to reduce the custom data. We provide a generic type that can be used in custom reductions, &lt;computeroutput&gt;Parallel::ReductionData&lt;/computeroutput&gt;, which takes a series of &lt;computeroutput&gt;&lt;ref refid=&quot;structParallel_1_1ReductionDatum&quot; kindref=&quot;compound&quot;&gt;Parallel::ReductionDatum&lt;/ref&gt;&lt;/computeroutput&gt; as template parameters and &lt;computeroutput&gt;ReductionDatum::value_type&lt;/computeroutput&gt;s as the arguments to the constructor. Each &lt;computeroutput&gt;ReductionDatum&lt;/computeroutput&gt; takes up to four template parameters (two are required). The first is the type of data to reduce, and the second is a binary invokable that is called at each step of the reduction to combine two messages. The last two template parameters are used after the reduction has completed. The third parameter is an n-ary invokable that is called once the reduction is complete, whose first argument is the result of the reduction. The additional arguments can be any &lt;computeroutput&gt;ReductionDatum::value_type&lt;/computeroutput&gt; in the &lt;computeroutput&gt;ReductionData&lt;/computeroutput&gt; that are before the current one. The fourth template parameter of &lt;computeroutput&gt;ReductionDatum&lt;/computeroutput&gt; is used to specify which data should be passed. It is a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/integer_sequence&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::index_sequence&lt;/ref&gt;&lt;/computeroutput&gt; indexing into the &lt;computeroutput&gt;ReductionData&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="454"><span class="lineNum">     454 </span>            : &lt;para&gt;The action that is invoked with the result of the reduction is:&lt;/para&gt;</a>
<a name="455"><span class="lineNum">     455 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmReduction.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;ProcessCustomReductionAction&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="456"><span class="lineNum">     456 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ParallelComponent,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="457"><span class="lineNum">     457 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="458"><span class="lineNum">     458 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/apply&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;apply&lt;/ref&gt;(db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*box*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="459"><span class="lineNum">     459 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*cache*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="460"><span class="lineNum">     460 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;int&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;reduced_int,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="461"><span class="lineNum">     461 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/unordered_map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::unordered_map&amp;lt;std::string, int&amp;gt;&lt;/ref&gt;&lt;sp/&gt;reduced_map,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="462"><span class="lineNum">     462 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;int&amp;gt;&lt;/ref&gt;&amp;amp;&amp;amp;&lt;sp/&gt;reduced_vector)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="463"><span class="lineNum">     463 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(reduced_int&lt;sp/&gt;==&lt;sp/&gt;10);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="464"><span class="lineNum">     464 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(reduced_map.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;unity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;==&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="465"><span class="lineNum">     465 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;number_of_1d_array_elements&lt;sp/&gt;-&lt;sp/&gt;1);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="466"><span class="lineNum">     466 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(reduced_map.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;double&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;==&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="467"><span class="lineNum">     467 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;2&lt;sp/&gt;*&lt;sp/&gt;number_of_1d_array_elements&lt;sp/&gt;-&lt;sp/&gt;2);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="468"><span class="lineNum">     468 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(reduced_map.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;negative&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;==&lt;sp/&gt;0);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="469"><span class="lineNum">     469 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="470"><span class="lineNum">     470 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;reduced_vector&lt;sp/&gt;==&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="471"><span class="lineNum">     471 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;(&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;int&amp;gt;&lt;/ref&gt;{-reduced_int&lt;sp/&gt;*&lt;sp/&gt;number_of_1d_array_elements&lt;sp/&gt;*&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="472"><span class="lineNum">     472 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;(number_of_1d_array_elements&lt;sp/&gt;-&lt;sp/&gt;1)&lt;sp/&gt;/&lt;sp/&gt;2,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="473"><span class="lineNum">     473 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;-reduced_int&lt;sp/&gt;*&lt;sp/&gt;number_of_1d_array_elements&lt;sp/&gt;*&lt;sp/&gt;10,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="474"><span class="lineNum">     474 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;8&lt;sp/&gt;*&lt;sp/&gt;reduced_int&lt;sp/&gt;*&lt;sp/&gt;number_of_1d_array_elements}));&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="475"><span class="lineNum">     475 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="476"><span class="lineNum">     476 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="477"><span class="lineNum">     477 </span>            : &lt;/programlisting&gt; Note that it takes objects of the types that the reduction was done over as additional arguments.&lt;/para&gt;</a>
<a name="478"><span class="lineNum">     478 </span>            : &lt;para&gt;&lt;simplesect kind=&quot;warning&quot;&gt;&lt;para&gt;All elements of the array must call the same reductions in the same order. It is &lt;emphasis&gt;defined&lt;/emphasis&gt; behavior to do multiple reductions at once as long as all contribute calls on all array elements occurred in the same order. It is &lt;bold&gt;undefined&lt;/bold&gt; behavior if the contribute calls are made in different orders on different array elements.&lt;/para&gt;</a>
<a name="479"><span class="lineNum">     479 </span>            : &lt;/simplesect&gt;</a>
<a name="480"><span class="lineNum">     480 </span>            : &lt;/para&gt;</a>
<a name="481"><span class="lineNum">     481 </span>            : &lt;/sect2&gt;</a>
<a name="482"><span class="lineNum">     482 </span>            : &lt;/sect1&gt;</a>
<a name="483"><span class="lineNum">     483 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1autotoc_md105&quot;&gt;</a>
<a name="484"><span class="lineNum">     484 </span>            : &lt;title&gt;Mutable items in the GlobalCache&lt;/title&gt;</a>
<a name="485"><span class="lineNum">     485 </span>            : &lt;para&gt;Most items in the GlobalCache are constant, and are specified by type aliases called &lt;computeroutput&gt;const_global_cache_tags&lt;/computeroutput&gt; as described above. However, the GlobalCache can also store mutable items. Because of asynchronous execution, care must be taken when mutating items in the GlobalCache, as described below.&lt;/para&gt;</a>
<a name="486"><span class="lineNum">     486 </span>            : &lt;para&gt;A mutable item can be of any type, as long as that type is something that can be checked for whether it is &amp;quot;up-to-date&amp;quot;. Here &amp;quot;up-to-date&amp;quot; means that the item can be safely used (even read-only) without needing to be mutated first. For example, a mutable item might be a function of time that knows the range of times for which it is valid; the mutable item is then deemed up-to-date if it will be called for a time within its range of validity, and it is deemed not up-to-date if it will be called for a time outside its range of validity. Thus the up-to-date status of a mutable item is determined by both the state of the item itself and by the code that wishes to use that item.&lt;/para&gt;</a>
<a name="487"><span class="lineNum">     487 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1autotoc_md106&quot;&gt;</a>
<a name="488"><span class="lineNum">     488 </span>            : &lt;title&gt;1. Specification of mutable GlobalCache items&lt;/title&gt;</a>
<a name="489"><span class="lineNum">     489 </span>            : &lt;para&gt;Mutable GlobalCache items are specified by a type alias &lt;computeroutput&gt;mutable_global_cache_tags&lt;/computeroutput&gt;, which is treated the same way as &lt;computeroutput&gt;const_global_cache_tags&lt;/computeroutput&gt; for const items.&lt;/para&gt;</a>
<a name="490"><span class="lineNum">     490 </span>            : &lt;/sect2&gt;</a>
<a name="491"><span class="lineNum">     491 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1autotoc_md107&quot;&gt;</a>
<a name="492"><span class="lineNum">     492 </span>            : &lt;title&gt;2. Use of mutable GlobalCache items&lt;/title&gt;</a>
<a name="493"><span class="lineNum">     493 </span>            : &lt;sect3 id=&quot;dev_guide_parallelization_foundations_1autotoc_md108&quot;&gt;</a>
<a name="494"><span class="lineNum">     494 </span>            : &lt;title&gt;1. Checking if the item is up-to-date&lt;/title&gt;</a>
<a name="495"><span class="lineNum">     495 </span>            : &lt;para&gt;Because execution is asynchronous, any code that uses a mutable item in the GlobalCache must first check whether that item is up-to-date. The information about whether an item is up-to-date is assumed to be stored in the item itself. For example, a mutable object stored in the GlobalCache might have type &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&amp;lt;temporal_id,T&amp;gt;&lt;/computeroutput&gt; (for some type &lt;computeroutput&gt;T&lt;/computeroutput&gt;), and then any code that uses the stored object can check whether an entry exists for a particular &lt;computeroutput&gt;temporal_id&lt;/computeroutput&gt;. To avoid race conditions, it is important that up-to-date checks are based on something that is independent of the order of mutation (like a &lt;computeroutput&gt;temporal_id&lt;/computeroutput&gt;, and not like checking the size of a vector).&lt;/para&gt;</a>
<a name="496"><span class="lineNum">     496 </span>            : &lt;para&gt;To check an item, use the function &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt;, which returns a bool indicating whether the item is up-to-date. If the item is up-to-date, then it can be used. &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt; takes a lambda as an argument. This lambda is passed a single argument: a const reference to the item being retrieved. The lambda should determine whether the item is up-to-date. If so, it should return a default_constructed &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/optional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::optional&lt;/ref&gt;&amp;lt;CkCallback&amp;gt;&lt;/computeroutput&gt;; if not, it should return a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/optional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::optional&lt;/ref&gt;&amp;lt;CkCallback&amp;gt;&lt;/computeroutput&gt; to a callback function that will be called on the next &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&lt;/computeroutput&gt; of that item. The callback will typically check again if the item is up-to-date and if so will execute some code that gets the item via &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga58e38397e3ac428c80fd30ba2f3d8096&quot; kindref=&quot;member&quot;&gt;Parallel::get&lt;/ref&gt;&lt;/computeroutput&gt;.&lt;/para&gt;</a>
<a name="497"><span class="lineNum">     497 </span>            : &lt;para&gt;For the case of iterable actions, &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt; is typically called from the &lt;computeroutput&gt;is_ready&lt;/computeroutput&gt; function of the iterable action, and the callback is &lt;computeroutput&gt;perform_algorithm()&lt;/computeroutput&gt;. In the example below, the vector is considered up-to-date if it is non-empty:&lt;/para&gt;</a>
<a name="498"><span class="lineNum">     498 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmGlobalCache.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;InboxTags,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Metavariables,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="499"><span class="lineNum">     499 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="500"><span class="lineNum">     500 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;namespaceActionTesting_1a47e1c0b16f47574d2242b7c02732a69c&quot; kindref=&quot;member&quot;&gt;is_ready&lt;/ref&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;db::DataBox&amp;lt;DbTags&amp;gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*box*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="501"><span class="lineNum">     501 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;InboxTags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*inboxes*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="502"><span class="lineNum">     502 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1GlobalCache&quot; kindref=&quot;compound&quot;&gt;Parallel::GlobalCache&amp;lt;Metavariables&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;cache,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="503"><span class="lineNum">     503 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;ArrayIndex&amp;amp;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;/*array_index*/&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="504"><span class="lineNum">     504 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;++number_of_calls_to_use_stored_double_is_ready;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="505"><span class="lineNum">     505 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;this_proxy&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1gab0de6c4b4047a7eb4cbe45a33faa3f41&quot; kindref=&quot;member&quot;&gt;Parallel::get_parallel_component&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="506"><span class="lineNum">     506 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;UseMutatedCacheComponent&amp;lt;Metavariables&amp;gt;&amp;gt;(cache);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="507"><span class="lineNum">     507 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;callback&lt;sp/&gt;=&lt;sp/&gt;CkCallback(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="508"><span class="lineNum">     508 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Parallel::index_from_parallel_component&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="509"><span class="lineNum">     509 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;UseMutatedCacheComponent&amp;lt;Metavariables&amp;gt;&amp;gt;::perform_algorithm(),&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="510"><span class="lineNum">     510 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;this_proxy);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="511"><span class="lineNum">     511 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;return&lt;sp/&gt;::Parallel::mutable_cache_item_is_ready&amp;lt;Tags::VectorOfDoubles&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="512"><span class="lineNum">     512 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;cache,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="513"><span class="lineNum">     513 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;[&amp;amp;callback](&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;double&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;VectorOfDoubles)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="514"><span class="lineNum">     514 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;-&amp;gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/optional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::optional&amp;lt;CkCallback&amp;gt;&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="515"><span class="lineNum">     515 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;VectorOfDoubles.empty()&lt;sp/&gt;?&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/optional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::optional&amp;lt;CkCallback&amp;gt;&lt;/ref&gt;(callback)&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="516"><span class="lineNum">     516 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/optional&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::optional&amp;lt;CkCallback&amp;gt;&lt;/ref&gt;{};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="517"><span class="lineNum">     517 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;});&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="518"><span class="lineNum">     518 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="519"><span class="lineNum">     519 </span>            : &lt;/programlisting&gt; Note that &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt; is called on a local core and does no parallel communication.&lt;/para&gt;</a>
<a name="520"><span class="lineNum">     520 </span>            : &lt;/sect3&gt;</a>
<a name="521"><span class="lineNum">     521 </span>            : &lt;sect3 id=&quot;dev_guide_parallelization_foundations_1autotoc_md109&quot;&gt;</a>
<a name="522"><span class="lineNum">     522 </span>            : &lt;title&gt;2. Retrieving the item&lt;/title&gt;</a>
<a name="523"><span class="lineNum">     523 </span>            : &lt;para&gt;The item is retrieved using &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga58e38397e3ac428c80fd30ba2f3d8096&quot; kindref=&quot;member&quot;&gt;Parallel::get&lt;/ref&gt;&lt;/computeroutput&gt; just like for constant items. For example, to retrieve the item &lt;computeroutput&gt;Tags::VectorOfDoubles&lt;/computeroutput&gt;: &lt;programlisting filename=&quot;Test_AlgorithmGlobalCache.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__TestingFrameworkGroup_1ga37fce1ae5980139598815eda5a5de8ab&quot; kindref=&quot;member&quot;&gt;SPECTRE_PARALLEL_REQUIRE&lt;/ref&gt;(Parallel::get&amp;lt;Tags::VectorOfDoubles&amp;gt;(cache)&lt;sp/&gt;==&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="524"><span class="lineNum">     524 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;expected_result);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="525"><span class="lineNum">     525 </span>            : &lt;/programlisting&gt; Note that &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga58e38397e3ac428c80fd30ba2f3d8096&quot; kindref=&quot;member&quot;&gt;Parallel::get&lt;/ref&gt;&lt;/computeroutput&gt; is called on a local core and does no parallel communication.&lt;/para&gt;</a>
<a name="526"><span class="lineNum">     526 </span>            : &lt;para&gt;Whereas we support getting &lt;emphasis&gt;non-mutable&lt;/emphasis&gt; items in the GlobalCache from a DataBox via &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gae08744824ea7df89224f128b2080c5b1&quot; kindref=&quot;member&quot;&gt;db::get&lt;/ref&gt;&lt;/computeroutput&gt;, we intentionally do not support &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gae08744824ea7df89224f128b2080c5b1&quot; kindref=&quot;member&quot;&gt;db::get&lt;/ref&gt;&lt;/computeroutput&gt; of &lt;emphasis&gt;mutable&lt;/emphasis&gt; items in the GlobalCache from a DataBox. The reason is that mutable items should be retrieved only after a &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt; check, and being able to retrieve a mutable item from a DataBox makes it difficult to enforce that check, especially when automatically-executing compute items are considered.&lt;/para&gt;</a>
<a name="527"><span class="lineNum">     527 </span>            : &lt;/sect3&gt;</a>
<a name="528"><span class="lineNum">     528 </span>            : &lt;/sect2&gt;</a>
<a name="529"><span class="lineNum">     529 </span>            : &lt;sect2 id=&quot;dev_guide_parallelization_foundations_1autotoc_md110&quot;&gt;</a>
<a name="530"><span class="lineNum">     530 </span>            : &lt;title&gt;3. Modifying a mutable GlobalCache item&lt;/title&gt;</a>
<a name="531"><span class="lineNum">     531 </span>            : &lt;para&gt;To modify a mutable item, pass &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&lt;/computeroutput&gt; two template parameters: the tag to mutate, and a struct with an &lt;computeroutput&gt;apply&lt;/computeroutput&gt; function that does the mutating. &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&lt;/computeroutput&gt; takes two arguments: a proxy to the GlobalCache, and a tuple that is passed into the mutator function. For the following example,&lt;/para&gt;</a>
<a name="532"><span class="lineNum">     532 </span>            : &lt;para&gt;&lt;programlisting filename=&quot;Test_AlgorithmGlobalCache.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&amp;lt;Tags::VectorOfDoubles,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="533"><span class="lineNum">     533 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;MutationFunctions::add_stored_double&amp;gt;(cache.thisProxy,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="534"><span class="lineNum">     534 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;42.0);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="535"><span class="lineNum">     535 </span>            : &lt;/programlisting&gt; the mutator function is defined as below: &lt;programlisting filename=&quot;Test_AlgorithmGlobalCache.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;namespace&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;MutationFunctions&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="536"><span class="lineNum">     536 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;add_stored_double&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="537"><span class="lineNum">     537 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/apply&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;apply&lt;/ref&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&amp;lt;double&amp;gt;&lt;/ref&gt;*&amp;gt;&lt;sp/&gt;data,&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="538"><span class="lineNum">     538 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;new_value)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="539"><span class="lineNum">     539 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/iterator/data&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;data&lt;/ref&gt;-&amp;gt;emplace_back(new_value);&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="540"><span class="lineNum">     540 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="541"><span class="lineNum">     541 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="542"><span class="lineNum">     542 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;namespace&lt;sp/&gt;MutationFunctions&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="543"><span class="lineNum">     543 </span>            : &lt;/programlisting&gt; &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&lt;/computeroutput&gt; broadcasts to every core, where it calls the mutator function and then calls all the callbacks that have been set on that core by &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1gac288b4e437376917e186f704aaeadcf8&quot; kindref=&quot;member&quot;&gt;Parallel::mutable_cache_item_is_ready&lt;/ref&gt;&lt;/computeroutput&gt;. The &lt;computeroutput&gt;&lt;ref refid=&quot;group__ParallelGroup_1ga964eab86069dc2de2f7dd55929e63ec7&quot; kindref=&quot;member&quot;&gt;Parallel::mutate&lt;/ref&gt;&lt;/computeroutput&gt; operation is guaranteed to be thread-safe without any further action by the developer.&lt;/para&gt;</a>
<a name="544"><span class="lineNum">     544 </span>            : &lt;/sect2&gt;</a>
<a name="545"><span class="lineNum">     545 </span>            : &lt;/sect1&gt;</a>
<a name="546"><span class="lineNum">     546 </span>            : &lt;sect1 id=&quot;dev_guide_parallelization_foundations_1dev_guide_parallelization_charm_node_processor_level_initialization&quot;&gt;</a>
<a name="547"><span class="lineNum">     547 </span>            : &lt;title&gt;Charm++ Node and Processor Level Initialization Functions&lt;/title&gt;</a>
<a name="548"><span class="lineNum">     548 </span>            : &lt;para&gt;Charm++ allows running functions once per core and once per node before the construction of any parallel components. This is commonly used for setting up error handling and enabling floating point exceptions. Other functions could also be run. Which functions are run on each node and core is set by specifying a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;void (*)()&amp;gt;&lt;/computeroutput&gt; called &lt;computeroutput&gt;charm_init_node_funcs&lt;/computeroutput&gt; and &lt;computeroutput&gt;charm_init_proc_funcs&lt;/computeroutput&gt; with function pointers to the functions to be called. For example, &lt;programlisting filename=&quot;Test_AlgorithmCore.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;void&lt;sp/&gt;(*)()&amp;gt;&lt;sp/&gt;charm_init_node_funcs{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="549"><span class="lineNum">     549 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&amp;amp;setup_error_handling};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="550"><span class="lineNum">     550 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;void&lt;sp/&gt;(*)()&amp;gt;&lt;sp/&gt;charm_init_proc_funcs{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="551"><span class="lineNum">     551 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&amp;amp;&lt;ref refid=&quot;group__ErrorHandlingGroup_1gac5fde843ca62e1d4288f4a4e6d480aa0&quot; kindref=&quot;member&quot;&gt;enable_floating_point_exceptions&lt;/ref&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="552"><span class="lineNum">     552 </span>            : &lt;/programlisting&gt; Finally, the user must include the &lt;computeroutput&gt;Parallel/CharmMain.tpp&lt;/computeroutput&gt; file at the end of the main executable cpp file. So, the end of an executables main cpp file will then typically look as follows: &lt;programlisting filename=&quot;Test_AlgorithmParallel.cpp&quot;&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;void&lt;sp/&gt;(*)()&amp;gt;&lt;sp/&gt;charm_init_node_funcs{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="553"><span class="lineNum">     553 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&amp;amp;setup_error_handling,&lt;sp/&gt;&amp;amp;&lt;ref refid=&quot;Blas_8hpp_1a5b54f526fe76418288fdf2dd79b0828e&quot; kindref=&quot;member&quot;&gt;disable_openblas_multithreading&lt;/ref&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="554"><span class="lineNum">     554 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/vector&quot; kindref=&quot;compound&quot; external=&quot;/__w/spectre/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::vector&lt;/ref&gt;&amp;lt;void&lt;sp/&gt;(*)()&amp;gt;&lt;sp/&gt;charm_init_proc_funcs{&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="555"><span class="lineNum">     555 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&amp;amp;&lt;ref refid=&quot;group__ErrorHandlingGroup_1gac5fde843ca62e1d4288f4a4e6d480aa0&quot; kindref=&quot;member&quot;&gt;enable_floating_point_exceptions&lt;/ref&gt;};&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="556"><span class="lineNum">     556 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="557"><span class="lineNum">     557 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;charmxx_main_component&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;classParallel_1_1Main&quot; kindref=&quot;compound&quot;&gt;Parallel::Main&amp;lt;TestMetavariables&amp;gt;&lt;/ref&gt;;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="558"><span class="lineNum">     558 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="559"><span class="lineNum">     559 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;preprocessor&quot;&gt;#include&lt;sp/&gt;&amp;quot;Parallel/CharmMain.tpp&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;IWYU&lt;sp/&gt;pragma:&lt;sp/&gt;keep&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;</a>
<a name="560"><span class="lineNum">     560 </span>            : &lt;/programlisting&gt;&lt;/para&gt;</a>
<a name="561"><span class="lineNum">     561 </span>            : &lt;/sect1&gt;</a>
<a name="562"><span class="lineNum">     562 </span>            :     &lt;/detaileddescription&gt;</a>
<a name="563"><span class="lineNum">     563 </span>            :   &lt;/compounddef&gt;</a>
<a name="564"><span class="lineNum">     564 </span>            : &lt;/doxygen&gt;</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
