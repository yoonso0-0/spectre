<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.17"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: Running and Visualizing</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="popper.min.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="index.html">
      SpECTRE &#160;
        <span id="projectnumber">v2020.12.07</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Introduction</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="versioning_and_releases.html">
              <i class="octicon octicon-versions"></i><span>Releases</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="installation.html">
              <i class="octicon octicon-desktop-download"></i><span>Installation</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>User Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="code_of_conduct.html">
              <i class="octicon octicon-comment-discussion"></i><span>Code of Conduct</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="contributing_to_spectre.html">
              <i class="octicon octicon-git-pull-request"></i><span>Contributing Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Code Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Topics</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <li>
        <a href="citelist.html">
          <i class="octicon octicon-file-text"></i><span>Bibliography</span>
        </a>
      </li>
      <li>
        <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
          <i class="octicon octicon-mark-github"></i><span>View on GitHub</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Running and Visualizing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md197"></a>
Building an Executable from an Existing Source File</h2>
<p>SpECTRE source files for evolution executables are located in <code>src/Evolution/Executables</code>. Executables can be compiled by running the command <code>make EXECUTABLE_NAME</code> where <code>EXECUTABLE_NAME</code> is the name of the executable as defined in the <code>CMakeLists.txt</code> file located in the same directory as the source file. For example, to compile the executable that evolves a scalar wave using a three-dimensional domain, one runs the command: <code>make EvolvePlaneWave3D</code>, which then results in an executable of the same name in the <code>bin</code> directory of the user's build directory.</p>
<h2><a class="anchor" id="autotoc_md198"></a>
Running an Evolution Executable</h2>
<p>Each SpECTRE executable reads a user-provided YAML file that specifies the runtime settings of the evolution. This is where options such as the <a class="el" href="classDomain.html" title="A wrapper around a vector of Blocks that represent the computational domain.">Domain</a>, AnalyticSolution, <a class="el" href="classTimeStepper.html">TimeStepper</a>, etc are supplied. Example input files are kept in <code>tests/InputFiles</code>, and are written to provide a functional base input file which the user can then modify as desired. Copy the executable and YAML file to a directory of your choice. The YAML file is then passed as an argument to the executable using the flag <code>--input-file</code>. For example, for a scalar wave evolution, run the command: <code>./EvolvePlaneWave3D --input-file Input3DPeriodic.yaml</code>. By default, the example input files do not produce any output. This can be changed by modifying the options passed to <code><a class="el" href="classEventsAndTriggers.html">EventsAndTriggers</a></code>:</p>
<div class="fragment"><div class="line">EventsAndTriggers:</div>
<div class="line">  ? Slabs:</div>
<div class="line">      EvenlySpaced:</div>
<div class="line">        Interval: 3</div>
<div class="line">        Offset: 5</div>
<div class="line">  : - ObserveErrorNorms:</div>
<div class="line">        SubfileName: Errors</div>
<div class="line">  ? Slabs:</div>
<div class="line">      Specified:</div>
<div class="line">        Values: [0, 100]</div>
<div class="line">  : - ObserveFields:</div>
<div class="line">        SubfileName: VolumePsi0And100</div>
<div class="line">        VariablesToObserve: [&quot;Psi&quot;]</div>
<div class="line">        InterpolateToMesh: None</div>
<div class="line">  ? Slabs:</div>
<div class="line">      EvenlySpaced:</div>
<div class="line">        Interval: 50</div>
<div class="line">        Offset: 0</div>
<div class="line">  : - ObserveFields:</div>
<div class="line">        SubfileName: VolumePsiPiPhiEvery50Slabs</div>
<div class="line">        VariablesToObserve: [&quot;Psi&quot;, &quot;Pi&quot;, &quot;Phi&quot;]</div>
<div class="line">        InterpolateToMesh: None</div>
<div class="line">  ? Slabs:</div>
<div class="line">      Specified:</div>
<div class="line">        Values: [100]</div>
<div class="line">  : - Completion</div>
</div><!-- fragment --><p> This will observe the norms of the errors in the system every three slabs starting with slab five and the volume data of Psi at the start of slabs 0 and 100. Be sure to keep the Completion event, as without it the executable will run indefinitely. In this case, it will terminate after 100 slabs. A successful observation will result in the creation of H5 files whose names can be specified in the YAML file under the options <code>VolumeFileName</code> and <code>ReductionFileName</code>. One volume data file will be produced from each Charm++ node that is used to run the executable. Each volume data file will have its corresponding node number appended to its file name. Visualization of the volume data will be described in the next section.</p>
<h2><a class="anchor" id="autotoc_md199"></a>
3D %Data Volume %Data In ParaView</h2>
<p>A SpECTRE executable with observers produces volume and/or reduced data <a class="el" href="namespaceh5.html" title="Contains functions and classes for manipulating HDF5 files.">h5</a> files. An XDMF file must be created from the volume data in order to do visualization using ParaView. To this end we provide the python executable <code>GenerateXdmf.py</code> in the <code>Visualization/Python</code> directory. <code>GenerateXdmf.py</code> takes two arguments which are passed to <code>--file-prefix</code> and <code>--output</code>. The argument passed to <code>--file-prefix</code> is the name of the H5 volume data, leaving out the node number and extension. The argument passed to <code>--output</code> is the desired .xmf file name, also without filename extension. Use <code>--help</code> to see a further description of possible arguments.</p>
<p>Open the .xmf file in ParaView and select the <code>Xdmf Reader</code>, <em>not</em> the version 3 readers. On the left hand side of the main ParaView window is a section named <code>Properties</code>, here you must click the highlighted <code>Apply</code> button. ParaView will now render your volume data. If you only wish to visualize a few datasets out of a large set, we recommended unchecking the boxes for the datasets you wish to ignore under <code>Point Arrays</code> before clicking <code>Apply</code>.</p>
<h2><a class="anchor" id="autotoc_md200"></a>
Helpful ParaView Filters</h2>
<p>Here we describe the usage of filters we've found to better visualize our data. Feel free to contribute to this section!</p>
<h3><a class="anchor" id="autotoc_md201"></a>
Removing Mesh Imprinting</h3>
<p>You may notice what appears to be mesh imprinting on the data. The imprinting effect can be removed by applying the <code>Tetrahedralize</code> filter. To apply the filter select the <code>Filters</code> menu item, then <code>Alphabetical</code> and finally <code>Tetrahedralize</code>.</p>
<h3><a class="anchor" id="autotoc_md202"></a>
Creating Derived Volume Data</h3>
<p>New volume data can be created from the existing volume data using the <code>Calculator</code> filter. In the <code>Calculator</code>'s text box, input a numerical expression in terms of existing datasets evaluating to the desired quantity. For example, a vector-valued velocity dataset can be created from three scalar velocity component datasets using the expression <code>velocity_x * iHat + velocity_y * jHat + velocity_z * kHat</code> and hitting the <code>Apply</code> button. By default, this will create a new dataset <code>Result</code>. The name of the new dataset can be changed by changing the name provided to <code>Result Array Name</code> above the <code>Calculator</code> text box.</p>
<h3><a class="anchor" id="autotoc_md203"></a>
Visualizing Vector Fields Derived From Scalar Fields</h3>
<p>Use the <code>Calculator</code> filter described above in "Creating Derived Volume Data" to create a new vector-valued dataset. Once this is created, use the <code>Glyph</code> filter and set the <code>Active Attributes</code> to the vector you wish to visualize. Make sure that <code>Scale Mode</code> is set to <code>vector</code>.</p>
<h2><a class="anchor" id="autotoc_md204"></a>
Reproducibility of Results</h2>
<p>Being able to reproduce the results of simulations is important for scientific integrity and accuracy. To this end, SpECTRE encodes the source tree, environment variables, and a record of the third party library versions into the executables. From most executables these can be retrieved using the flags <code>--dump-source-as filename_without_extension</code>, <code>--dump-paths</code>, <code>--dump-library-version</code>, and <code>--dump-environment</code>. The flag <code>--dump-only</code> will cause the program to exit after the information has been dumped. You can use the <code>--help</code> flag to get more details on what flags are available. The flag <code>--dump-paths</code> will print to screen the environment variables <code>PATH</code>, <code>CPATH</code>, <code>LD_LIBRARY_PATH</code>, <code>LIBRARY_PATH</code>, and <code>CMAKE_PREFIX_PATH</code> at link time. The flag <code>--dump-library-versions</code> will print to screen the contents of the <code>LibraryVersions.txt</code> file generated by CMake. The flag <code>--dump-environment</code> will print to screen the output of <code>printenv</code> at link time. Finally, the flag <code>--dump-source-as filename_without_extension</code> will dump the archive <code>filename_without_extension.tar.gz</code>, which contains the entire source tree at link time. The combined above information should be enough to reproduce simulations results to roundoff error as long as the third party libraries used to build the executable have not changed on the system the simulation was run on.</p>
<p>Often only data from the simulation is retained, not the entire executable. In order to make simulations reproducible from only the HDF5 output, any HDF5 files written with SpECTRE's HDF5 wrappers contain the info about the run, output of <code>printenv</code> at link time, the contents of <code>LibraryVersions.txt</code>, and an archive of the source tree. These are inside the <code>header.hdr</code> group with names <code>SimulationInfo</code>, <code>EnvironmentVariablesAtCompilation</code>, <code>LibraryVersions</code>, and <code>src.tar.gz</code>. The source archive can be extracted by running the command </p><div class="fragment"><div class="line">h5dump -d /src.tar.gz -b LE -o src.tar.gz /path/to/hdf5/file.h5</div>
</div><!-- fragment --><p>You will need to make sure the argument to <code>-b</code> is the same endianness as your computer. In the above example little endian is used. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017 - 2020
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
